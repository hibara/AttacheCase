======================================================================
#アタッシェケース    ver.2.8.4.0               2018/08/03
Copyright(C) 2002-2018 ひばら みつひろ http://hibara.org/
======================================================================

##ソフト説明
-------------------
「アタッシェケース」は日常的に使うことを想定し、見た目のシンプルさと
簡便な操作性に注力しながらも、世界標準の暗号アルゴリズムを採用した強力
なファイル/フォルダ暗号化ソフトです。

ファイルをドラッグ＆ドロップするだけで、簡単に暗号化することができ、
フォルダごとドラッグ＆ドロップした場合には、１つにまとめて暗号化
ファイルを作ります（フォルダごとパックします）。

なお、暗号化の際にはデータに圧縮がかかりますので、サイズがコンパクトに
なります。

復号化する（元に戻す）際にもドラッグ＆ドロップするか、ダブルクリックし
てパスワードを入力するだけで、簡単に元のファイルやフォルダに戻すことが
できます。

また、実行形式（*.exe）ファイルとして出力できますので、アタッシェケース
を持たない人へ暗号化ファイルを渡すことができ、復号することができます。

暗号化アルゴリズムには、2000年10月にアメリカ政府標準技術局（NIST）に
よって、次世代暗号化標準 AES（Advanced Encryption Standard）として選定
された“Rijndael（ラインダール）”を採用し組み込んでいます。AESではブ
ロック長が128ビット固定となっていますが、アタッシェケースではRijndael
の仕様を採用し、鍵、ブロック長ともに256ビットになっています。

なお、乱数による初期化ベクトル（IV）を生成してからCBCモードで暗号化し、
第三者による解析も防ぐよう工夫されています。

     ※『アタッシェケース』は、2012年7月 ver.2.8.0.0 よりオープン
        ソースとして公開することになりました。詳しくは、次の
       「オープンソース」「ライセンス」の項目をご覧ください。


##オープンソース
-------------------
開発当初から「アタッシェケース」はフリーソフトではありましたが、
2012年7月からオープンソースとして公開することにしました。

今後は、GitHubを使って随時アップデートしていきます。

https://github.com/hibara/AttacheCase

興味がある方は、ぜひフォークするなり、他のプラットフォームへ
インプリメントするなり、ご自由にどうぞ。プルリクエスト大歓迎。

今後は、こうしてフィードバックを受けて改良しつつ、「大丈夫かな」という
頃合いを見計らってビルドし、公開していこうと思っています。


##ライセンス
-------------------

BSDライセンス（The BSD 3-Clause License）

を適用します。

当初、GPLv3ライセンス（https://www.gnu.org/licenses/gpl-3.0.html）を適
用しておりましたが、他のプロプライエタリなソフトウェアのライブラリなど
にリンクする際（iOSやMacOSなど）、GPLのソース公開規定に引っかかり、
やや使いにくいライセンス形態だ、というご意見をいただきました。

作者としては、より自由に、広く頒布していただきたい、という想いがありま
したので、より運用しやすい、このライセンスへの変更を決めました。

以下の著作権およびライセンス条文自身を、派生物のどこかに表示を行ってい
ただければ、実行ファイルを含む、すべてのソースを商用・私用にかかわらず、
複製、改変、および再頒布することができます。

======================================================================
アタッシェケース（AttachéCase）
Copyright (c) 2002-2018, Mitsuhiro Hibara ( http://hibara.org )
All rights reserved.

Redistribution and use in source and binary forms, 
with or without modification, are permitted provided that the following 
conditions are met:

・Redistributions of source code must retain the above copyright 
  notice, this list of conditions and the following disclaimer.
・Redistributions in binary form must reproduce the above copyright 
  notice, this list of conditions and the following disclaimer 
  in the documentation and/or other materials provided with the 
  distribution.
・Neither the name of the "HIBARA.ORG" nor the names of its 
  contributors  may be used to endorse or promote products derived 
  from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT 
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR 
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT 
HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT 
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY 
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT 
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE 
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
======================================================================
　※ただし、アタッシェケース内で使っている別作者によるライブラリは、
　　それぞれのライセンスに従ってください。

本ソフトウェアの使用、改変、再頒布、販売などは、上記のライセンスに
従ってください。この件に関して作者への問い合わせはなるべくお控えくださ
い（忙しいもので）。

ただ、「使っているよ！」「ちょっとソースコードを改良してみたよ！」と
いった応援は大歓迎です。以下のサイトからご連絡いただけると助かります。

ひばら　みつひろ
http://hibara.org/

バグや、修正依頼に関しては、以下のページから行っていただければ、重複す
ることなく整理でき、作者としてはたいへん助かります。

GitHub - Issues
https://github.com/hibara/AttacheCase/issues


なお、雑誌掲載や、アタッシェケースを含むサポートサイトの紹介や、リンク
は自由です。連絡も不要です（基本的に返信は無いとお考えください）。


##動作環境
-------------------
基本的に、Windows98/NT/2000/XP/Vista/7/8 でご使用いただけます。

現在、英語版などの他言語はありませんが、将来的に翻訳していただける方が
いらっしゃれば、順次対応していきます。

翻訳していただける方がいれば、ぜひ作者までご一報ください！

なお、Windowsにある一部のDLLファイルが古いと、まれに動作しないことがあ
ります。詳しくは、ヘルプファイルの「動作環境」の欄を参照ください。

※Windows95で動作させると、一部関連付け設定がきかない、ネットワーク上
  のファイルを暗号化できないなどの問題があります。


##アンインストール
-------------------
通常のインストーラーを使ってインストールされた場合は、プログラムメニュー
の「アタッシェケース」から「アンインストール」を選択すれば、レジストリ
も含め、削除されます。

もし手動でのインストールを行った場合は、以下を参考にしてください。

◇関連付け設定を解除するには...
  *.atcファイルへの関連付け設定を解除したい場合は、上記の削除を行う前
  に、AttacheCase.exe を起動して、「設定(T)」→「動作設定(O)」から「シ
  ステム」タブを選び、「暗号化ファイル（*.atc）の関連付け解除」ボタン
  を押してください。システムから関連付け設定が削除されます。

◇手動でレジストリを削除するには...
  アンインストールのメニューから行えば、レジストリ情報は削除されますが、
  もしも何らかの理由で手動削除を行いたい場合は、以下のレジストリを削除
  してください。

  HKEY_CURRENT_USER\Software\Hibara\AttacheCase 

【注意！】 
 ※手動でレジストリ操作を行う場合は、十分な知識と注意が必要です。自信
   のある方のみ行ってください。誤ったレジストリ操作によってシステムに
   何らかの障害が起こっても、当方では責任は負いかねます。
 ※レジストリがそのまま残っていたとしても、今後の動作に何の支障もあり
   ません。自信のない方はやめておきましょう（^^;）


##改版履歴
-------------------
『アタッシェケース』の改版履歴は以下の通りです。

ver.2.8.4.0　  2018/08/03
              ・さらなるディレクトリトラバーサル対策。
              ・zlibライブラリを更新（ver.1.2.11）

ver.2.8.3.0　  2017/01/12
              ・ディレクトリトラバーサル対策。
              ・zlibライブラリを更新（ver.1.2.10）

ver.2.8.2.8　  2013/02/14
              ・「基本設定」に新しく「常にウィンドウを最小化して処理する」
                を追加。また、タスクトレイにアイコンを表示して暗号化/
                復号処理する設定も追加した。
              ・トップのイメージ画像を少しだけデザイン変更した。
              ・コマンドラインオプションから起動したときも、フォームの
                位置・サイズ設定などをレジストリへ記録してしまっていた
                不具合に対処。
              ・旧バージョン（ver.2.75以前）と併用して使っていた場合、
                旧バージョンをアンインストールした際に、レジストリに
                記録された設定が消去されてしまう問題に対処。
              ・コンペアするファイルに0バイトファイルが含まれていると
                エラーが発生して処理が停止してしまう不具合に対処。
              ・簡体字中国語などがファイル名に混じると、復号できずに
                エラーとなっていた不具合に対処。
              ・連続してファイルを処理するとき、「同名ファイルの上書き
                を確認する」設定していて、かつ上書きを確認するダイアロ
                グが出て「すべてはい」を選択しても、再びダイアログが出
                てしまっていた不具合に対処。
              ・コマンドラインオプションの「/list」で指定したファイル
                リストを暗号化した際、一部のファイルしか削除できなかっ
                た不具合に対処。
              ・動作設定パネルで、左のアイコンメニューがすべて消えたり、
                その消えたアイコンをクリックするとエラーメッセージが出
                ていた問題に対処。
              ・動作設定パネルの各設定項目のタブ順序がバラバラだった
                ものを上→下へと整えた。
              【ソースレベルの変更点】
              ・旧バージョンを使っていた場合、つまりレジストリ
              （HKEY_CURRENT_USER\Software\Hibara\AttacheCase\AppInfo\
                AppVersion）に格納されているバージョンをチェックし、
                AttacheCase.BAKキーを追加してコピー・バックアップする
                ようにした。その後、AttacheCase.BAKを残してメインのレ
                ジストリが削除されたとき、そこから復旧されるように改良
                を加えた。
              ・(String)FilePath1 == (String)FilePath2 といった書き方で、
                ファイルパスの大文字・小文字の区別して判定してしまう
                可能性のある箇所を修正した。具体的には、CompareIC()を
                使うようにした。FilePath1.CompareIC(FilePath2) == 0;

ver.2.8.2.7　  2013/01/27
              ・アタッシェケースの古いバージョン（ver.1～）で暗号化
                されたファイルの復号に対応した。
              ・関連付けされたファイルからアタッシェケースを起動して、
                動作設定パネルを出してOKボタンを押すとエラーが発生して
                いた問題に対処。
              ・新版を起動・終了後、旧バージョン（ver.2.75以前）を起動
                すると、一部レジストリが読み込めず、設定が正しく反映さ
                れていなかった不具合に対処。※一応、下位互換にはしてい
                るつもりなので、これは「バグ」として対処しました。
              ・「デスクトップで最前面にウィンドウを表示する」設定を行っ
                たとき、アタッシェケースの再起動を行わないと反映されな
                いことがわからないため、項目にその旨の説明を追加記載した。
              【ソースレベルの変更点】
               ・TRegistryIniFileクラスでレジストリに書き込むと、中途
                 半端にint が、「REG_DWORD」だったり、「REG_SZ」であっ
                 たりと、一定した規則で書き込まれないことから、すべて
                 WriteStringで書き込むことにした。読み込むときには、
                 各値に応じてReadInteger, ReadBool, ReadStringと分けて
                 問題なし（※おそらくですが、INIファイル書き込みとの
                 互換性を保つための処理でREG_SZとして書き込まれるよう
                 ですが、REG_WORDになるときもあり、やや不可解な挙動で
                 す。C++Builder2010のバグ？）。
               ・アタッシェケース（ver.1）で暗号化されたファイルを復号
                 する“TAttacheCaseFileDecrypt1.cpp”を追加。※移植さ
                 れる際は、ver.1の暗号化ファイルは、ECBモードで暗号化
                 されている点だけご注意ください。
               ・“fmOpenRead | fmShareDenyNone”オプションでファイル
                 を開いていた箇所を、“fmOpenRead | fmShareDenyWrite”
                 とし、書き込みだけをブロックするように変更した。

ver.2.8.2.6　  2013/01/21
              ・「動作設定の出力」で「現在の動作設定を出力する」を選択
                すると強制終了していた不具合に対処。
              ・きちんと暗号化ファイルのヘッダの判定が行われていなかった
                部分を修正。
              ・実行形式の暗号化ファイルを復号できていなかった（暗号化
                処理へ移行してしまっていた）不具合に対処。
              ・「保存設定」の「自動で暗号化ファイル名を付加する」の
                テキストボックスに文字を入力できなかった不具合に対処。
              ・「暗号化した後にデータのコンペアを行う」を設定している
                際に、暗号化処理終了後、正常にコンペアに移行していなかっ
                た不具合に対処。
              ・コンペア自体にも各所問題があったので修正を施した。
              ・「保存設定」の「常に同じ場所へファイルを復号する」に
                設定しても、ファイルパスが設定できていなかった不具合に
                対処（暗号化する場所の方へ設定しに行っていたという凡ミス
                です。すみません・・・）。
              ・ver.2.75以前で「複数ファイルを一つにまとめる」オプション
                で暗号後に、最新版で復号すると正常に戻らない不具合に、
                とりあえず復号できるように対処（ややフォルダー階層が深
                く復号されるかもしれません・・・将来的に修正していく
                予定です）。
              【ソースレベルの変更点】
              ・復号時の成否判定に使うトークン（“_AttacheCaseData”）や、
                ファイル破壊を示すトークン（“_Atc_Broken_Data”）を
                終端文字を含まない16バイトで確保していたが、処理系によっ
                ては意図しない動作になる可能性があるので、移植されるこ
                とも考え、17バイトで確保し、文字列の比較関数もmemcomp
                から、StrComp(VCL)に修正し統一した。

              ・コンペアが正常に動作しない箇所が複数箇所見つかったので、
                TAttacheCaseFileDecrypt2.cpp にある「コンペア」処理の
                箇所に抜本的な修正を加えた。
              ・前回修正を加えたファイルを開く箇所（TFileStream）すべて
                のオプションを“fmOpenRead | fmShareDenyNone”変更して
                統一。

ver.2.8.2.5　  2013/01/16
              ・ファイルをアタッシェケースアイコンへドラッグ＆ドロップ
                した際に、動作設定が保存されていなかった不具合に対処
               （コマンドラインオプションからの動作と認識してしまって
                 いたようです）。
              ・カレントディレクトリ、またはアタッシェケース本体のある
                ディレクトリに置かれた「_AtcCase.ini」を正常に読み書き
                できていなかった不具合に対処。
              【ソースレベルの変更点】
              ・ファイルを「fmOpenRead」オプションで読み込んでいたとこ
                ろにご指摘があり、「fmShareDenyRead」を加えてみた。
                ※これにより他のアプリケーションが使用中のファイルでも
                  暗号化できる場合があります（すべてではありません）。

ver.2.8.2.4　  2013/01/11
              ・先の修正の影響で設定をレジストリから読み込むとき正常に
                読み込まれなくなっていた不具合に対処。
              ・ゼロバイトファイルが暗号化ファイルに含まれると、正常に
                復号できていなかった問題に対処。
              ・暗号化処理する合計サイズがゼロのとき、進捗表示が全く
                行われず、完了の表示が出なかった不具合に対処。
              ・関連付けアイコンの変更を行ったときに、レジストリ登録へ
                の処理が実行されなかった不具合に対処。
              ・動作設定パネルの各テキストボックスで、想定以上の巨大な
                文字列を入れると正常に動作せず、レジストリを削除しない
                かぎり設定パネルを開けなくなる問題に対処。
              ・コマンドラインオプションで、「常に自己実行形式で出力す
                る」(/exeout)と、「暗号化した後、元ファイルを削除する」
                (/del=[0,1,2,3])、「復号化した後、暗号化ファイルを削除
                する」(/delenc=[0,1,2,3])が機能していなかった不具合に
                対処。

ver.2.8.2.3　  2013/01/10
              ・暗号化ファイルを実行形式で出力すると、強制終了する問題
                に対処。
              ・保存設定の「常に同じ場所へ暗号化ファイルを保存する」
                または、「常に同じ場所へファイルを復号する」をチェック
                するとフリーズしてしまう問題に対処。
              ・ファイルの関連付け（AtcSetup.exe）が全く機能していなかっ
                た不具合に対処。
              ・同様に「送る」フォルダーにショートカットファイルを作成
                できていなかった不具合に対処。
              ・コマンドライン引数からパスワードを設定した場合に、
                きちんと機能していなかった不具合に対処。
              ・実行形式出力されたファイルの復号が完了したとき（または
                エラーでキャンセルして処理を抜けたとき）、キャンセルボ
                タンのラベルを「終了」に変更するように改良。
              ・実行形式出力で復号した後に「終了」ボタンを押した場合は、
                元のウィンドウに戻らずに終了するように改良。

ver.2.8.2.2　  2013/01/08
              ・旧バージョン（ver.2.75以前）などで、保存設定の「複数
                ファイルは一つの暗号化ファイルにめとめる」として暗号化
                したファイルを復号すると、正常にファイルが戻らなかった
                不具合に対処。
              ・実行形式で出力するとサイズが大きくなってしまっていた
                問題に対処（無駄に大きいアイコンファイルを含めてしまっ
                ていたようです）。

ver.2.8.2.1　  2013/01/06
              ・「保存設定」の「複数ファイルがあるときの処理」で、
               「フォルダ内のファイルは個別に暗号化/復号する」を選択し
                ていた場合、正常に暗号化の処理が行われなかった不具合に
                対処。
              ・同様に「複数ファイルは一つの暗号化ファイルにめとめる」で、
                複数ファイルをドロップしたとき、正常にサイズを計算でき
                ておらず、進捗表示が正確でなかった不具合に対処。
              ・設定によっては削除処理が行われず、元ファイルが残って
                しまっていた不具合に対処。
              ・復号後に削除処理が入ったとき、強制終了してしまうことが
                あった不具合に対処。
              【ソースレベルの変更点】
              ・ソースファイルの先頭部分にあったライセンス条項をBSD
                ライセンスに変更。
              ・暗号化/復号/削除スレッドに渡すファイルリストの定義場所
                がマチマチで予期せぬタイミングで破棄されたりしていたた
                め、きちんとスレッドに渡し、スレッド内ですべて破棄する
                ように改良。
              ・暗号化したときに処理するすべてのファイルリストを取得し
                ているので、それを削除処理でも利用するようにして少しだ
                けパフォーマンスを向上させた。
              ・復号時のスレッドオブジェクトの破棄のタイミングが怪しかっ
                たので、確実に破棄されるように修正。

ver.2.8.2.0　  2013/01/04
              ・長らくβテスト中だった新バージョンを正式版として昇格。
              ・ライセンスをGPLv3から、BSDライセンスへ変更。
              ・書き込み速度の遅いリムーバブルディスクなどで暗号化する際、
                実行形式出力を書き込む部分で処理が停まっているように見
                えたので、そのサイズも全体の処理サイズとして進捗状況を
                表示するように改良。

----------------------------------------------------------------------

ver.2.8.1.0β  2012/12/23
              ・暗号化時にUnicode文字列を含むファイルを含めると、復号
                時、正常にファイル名が戻らない不具合に対処（改修を続け
                る内にいつの間にか先祖返りしておりました。申し訳ありま
                せん・・・）。

ver.2.8.0.9β  2012/12/17
              ・「複数ファイルは一つの暗号化にまとめる」オプションを
                選択した状態で実行すると、保存ダイアログの拡張子が
                正しく表示されていなかった不具合に対処。
              ・暗号化した後の削除処理への移行が正常に行われていなかっ
                た不具合に対処。
              ・削除設定が正しく反映されないことがあった不具合に対処。
              ・保存設定の状態によっては完全削除処理に移行した場合に、
                強制終了してしまう不具合に対処。
              ・復号後にファイルのタイムスタンプが正常に設定されて
                いなかった不具合に対処。
              ・動作設定で、メインフォームに実行形式出力のチェックボッ
                クスを表示させたときに、反映しないことがあった不具合や、
                暗号化パスワード確認パネルに移行したとき、そのチェック
                が外れる不具合を修正した。
              ・ヘルプファイル内容を見直し、各ページを大幅に改訂。
              【ソースレベルの変更点】
              ・TAttacheCaseDelete.cpp の大改造。FileListなど、
                グローバル変数名とローカル変数名が重複していたり、
                削除するファイルリストを取得する流れを整理するなどの
                修正変更を行った。
              ・フォームにチェックボックスの表示・非表示と、チェック
                有無の反映処理と、各コンポーネントが配置されるルーチン
                を分離させた（正確には、表示、チェック処理は、コンポー
                ネントの配置を行うSetFormComponent関数内ではなく、
                PageControlのChangeイベント内で処理するようにした）。
              ・「削除設定」でゼロ書き込み、乱数書き込みが両方ともに
                「0」の場合や空になったときに、「通常削除」設定になる、
                といった細かい挙動の調整。

ver.2.8.0.8β  2012/11/11
              ・前バージョンの関連バグで、比較的大きいデータを複数ファ
                イル復号するには問題はなかったが、わりと小さいファイル
                などを暗号化すると、同様に一部データが破壊されるなど、
                致命的な不具合に対処した。
                ※カレントバージョン（ver.2.75）では問題なく復号できます。
                  万が一の場合は、そちらで復号してください。暗号化処理
                  には問題はなく、復号の方に問題があったということにな
                  ります。
              ・ノートパソコンなど小さな画面で見ると、ウィンドウがやや
                大きい気がしたので、サイドメニュー含めてデザインのダウ
                ンサイジングを行った。
              ・デバッグ＆テストのとき不便だったので(笑)、ウィンドウの
                最小化・最大化などをコマンドラインオプションから指定で
                きるようにした（※ /ws=[0,1,2]）。
              【ソースレベルの変更点】
              ・主に暗号化/復号におけるパディング処理周りの修正を行った。
                TAttacheCaseFileEncrypt.cpp,
                TAttacheCaseFileDecrypt2.cpp
                の両ソースを修正。暗号化の処理では、データの末尾の処理、
                つまりパディングの処理が正しく行われておらず、かつ復号
                も同様に正しく行われていなかった。
              ・暗号化でのパディングにおいて、意図せず unsigned char 
                ではなく int が書き込まれていたため、復号でパディング
                を解釈できず、データ境界が意図せず破壊されることがあった。
              ・ちなみに、カレントバージョン（ver.2.75）で問題なく復号
                できたのは、バッファを余裕にもって処理しているため、厳
                密な末尾境界の判定をする必要がないためです（適当にやっ
                ていた方が正常動作するとは・・・苦笑）。

ver.2.8.0.7β  2012/11/03
              ・フォルダなど複数ファイルが暗号化データを復号すると、一
              部データが破壊されるなど、致命的な不具合を修正。
              ※カレントバージョン（ver.2.75）では問題なく復号できます。
              暗号化処理には問題はなく、復号だけに問題がありました。

ver.2.8.0.6β  2012/10/29
              ・Windows8で暗号化ファイル(.atc)の関連付け設定が正常に行
                われていなかった不具合に対処。
              ・カレントバージョン（ver.2.75）にはあったマルチタッチ
                機能をすっかり入れ忘れていたので(笑)、追加した。
              ・ウィンドウ内をドラッグしてもフォームを移動できるように
                改良（Windows8でのタッチ操作を想定）。
              【ソースレベルの変更点】
              ・たまたま最新の「C++Builder XE3」でビルドする機会があった
                ので実行してみたら、各所でエラーが出たので、一応最新の
                開発環境でもビルドできるよう、その対処を入れた。
              ・関連付けのバグもあったので、AtcSetup.exeのソースを少し
                整理して書き直した。また、関連付けが正常に行われなかった
                場合など、各所で問題が起きたときにエラーを表示するよう
                に改良。

ver.2.8.0.5β  2012/10/23
              ・INIファイルオプションを正常に読み込めていない場合があった
                不具合に対処。
              ・進捗のパーセンテージ表示を小数点第一まで表示するように
                改良（約100MB以上の大きいデータを処理する場合）。
              ・暗号化または復号処理中にサイドバーをクリックすると動作
                設定パネルを呼び出すなどしていた不具合に対処。
              ・また、処理中のファイル名をウィンドウキャプション（＝タ
                スクバーに表示される内容に）表示するように改良。
              ・タスクバーにプログレスバーが正常に表示されていなかった
                不具合に対処した。
              ・まだ一部書きかけの部分があるが、新しくヘルプファイルを
                作成。サイト上での使い回しや画像の取り扱いなどが便利な
                ため、HelpNDocを使わず、元に戻した（すみません・・・）。

ver.2.8.0.4β  2012/10/15
              ・複数の暗号化ファイルを続けて復号処理すると、一部の
                ファイルで暗号化されていない不具合に対処。
              ・メインフォームのUIを全面的に改良した。
                それに伴って動作設定パネルのメニューデザインもそれに
                統一した。
              ・動作設定パネルのメニュー部分をダブルクリックすることで
                表示していたデバッグ表示が正常に動作せずエラーになって
                いた不具合に対処。
              ・関連付けを実行した際に、ファイルアイコンがきちんと
                レジストリに登録されていなかった不具合に対処。
              ・二重起動したときに不正な処理となり、後続のアタッシェ
                ケースがエラーを出力して起動していなかった不具合に対処。
              ・「元ファイルの削除」「暗号化ファイルの削除」のチェック
                ボックスがフォームに表示されていなかった不具合に対処。
              ・完全削除周りの機能を実装。動作設定で指定した回数分処理
                されていなかったり、途中キャンセルできないなど、だいぶ
                抜け落ちていた箇所を修正した。
              ・暗号/復号/完全削除処理間の処理移行、ユーザーキャンセル
                などの流れをきちんと整理した。
              ・また処理中のメッセージ表示（ファイル名など）がチラつい
                たりしていた不具合に対処。
              ・記憶パスワードがINIファイルまたはレジストリに書き込み
                は出ていたが、読み出しに失敗していた不具合に対処。

ver.2.8.0.3β  2012/08/30
              ・パスワードファイルでの暗号化/復号ができなかった問題に
                対処。
              ・INIファイル読み込みによる動作設定が機能していなかった
                バグ（すべてレジストリに記録されていたバグ）を修正。
              ・動作設定パネルで、パスワードを自動でチェックする機能を
                ＯＮにすると強制終了してしまう不具合に対処。
              ・動作設定パネルで保存先フォルダーや、パスワードファイル
                などをドラッグ＆ドロップすると強制終了してしまっていた
                不具合に対処。
              ・処理完了後のキャンセルボタンを「OK」と表示するようにした。
               「Cancel」のままではわかりにくいため。
              ---
              【ソースレベルの変更点】
              ・メインフォームと動作設定パネルの依存を切り、オプション
                ハンドルクラスを介して行うようにした（移植しやすいように）。
              ・まだ、動作設定周りだけですが、try ～ __finallyブロックで
                実行するようにし、例外が発生しても正常な動作を期待できる
                ように改良した。
              ・暗号化/復号ともにpublic変数から直接パスワード（key）
                をいじれないようにし、関数から取得、privateへセットする
                ようにした。
              ・パスワードファイルのハッシュ値をテキストボックスなど、
                C++Builderのコンポーネントを通してしまうとUnicode文字列
                として暗黙的に扱われてしまうので、計算したハッシュ値は
                直接それぞれのクラスへ渡すように改良した。

ver.2.8.0.2β  2012/08/06
              ・「自動で暗号化ファイル名を付加する」設定をONにした状態
                で、再度動作設定パネルを開くと、アタッシェケースが正常
                に動作しなくなる不具合に対処。
              ・また、「ファイル名」「拡張子」書式の挿入が正常に行われ
                ていなかった不具合を修正。
              ・記憶パスワード周りが正常に動作していなかった不具合に対処。
                記憶された復号パスワードが正常に入力されておらず、かつ
                暗号/復号処理に移行したとき、きちんと記憶パスワードが
                テキストボックスに入るように改良した。
              ・復号処理スレッドの終了周りが非常に怪しい動きをしていた
                ので修正（復号スレッドオブジェクトの処理を正しく行って
                おらず例外が発生したりなどしていた）。
              ・Unicodeのファイルリストが正しく保存されないことがあった
                ので少しだけ改良。
              （具体的に言えば、UTF-8として保存するのではなく、TBytesで
                ファイルリスト文字列を保存するようにした。）

ver.2.8.0.1β  2012/07/17
              ・復号時にパスワードをミスタイプしたとき、そのエラーメッ
                セージ表示の処理分けをしていなかった不具合を修正。
                パスワードの再入力を促すようにした。
              ・復号処理後のステータスが正しく返っていなかったので修正
               （正しく復号されてはいるが、処理中のままになっているこ
                とがあった）。
              ・ミスタイプ回数制限によるファイル破壊機能が実装されてい
                なかったので改めて追加した。
               （※ただし、自己実行形式の場合は破壊される終了されるのみ
                   となります。）
              ・付属の関連付けツール（AtcSetup.exe）が正常に機能して
                いなかった問題に対処。
              ・アタッシェケース終了時に設定を保存していなかった問題に
                対処。
              ・インストーラー（InnoSetup）で、ユーザーが選択した
                ディレクトリにアンインストーラー以外のものが正しくイン
                ストールされていなかった問題を修正。
              ・動作設定パネルの項目選択のドロップシャドウが表示されて
                いなかった不具合に対処し、デザインも少し調整した。
              ・暗号/復号処理でエラーが発生したときに、きちんとメイン
                フォームへ戻るように修正（そのままパスワード入力フォーム
                に進んでいた）。

ver.2.8.0.0β  2012/07/05
              ・オープンソース化するにあたってすべての処理を見直し、
                フルスクラッチで書き直した。
              ・暗号化/復号処理をマルチスレッド処理にし高速化。
              （やや深い説明をするならば、TThreadを継承したクラスとし
                てソースを分離して独立させました。これにより他のプログ
                ラミング言語やプラットフォームに移植しやすくなったと考
                えます）。
              ・Unicodeに完全対応（ただしデータ仕様は仮。変更の可能性
                あり）。
              ・データ末尾の処理が正しく行われていなかったものをPKCS7で
                処理するようにした（これにより復号時のエラーが軽減され
                ると思われます）。 
              ・初期化ベクトルの生成をCRNG（ISAAC）に変更し、乱数の質を
                向上させた（それによりセキュリティーが著しく向上するわ
                けではありませんが、一応入れてみた、という感じです）。

----------------------------------------------------------------------

ver.2.75     2011/04/30
            ・マルチタッチモニターに対応。それに伴いメインフォームデザ
              インの一新と、二点タッチによるウィンドウの拡大・縮小に対
              応した。
            ・マルチタッチ（主にスレートPC用途）で扱いやすいように、ウィ
              ンドウを最前面にするON/OFFオプションをメインフォームに出
              してみた。
             （※実験的な意味合いがありますので、不評なら再考します。）
            ・プログレスバーを自作のカスタムドローのものから、速くて表
              示のきれいなVCLのものに置換した（Windows7が主流となり、
              やや苦しくなってきたので‥‥）。
            ・環境によってはメモリ不足で強制終了することがあったため、
              メモリの断片化が起きないように確保の仕方を工夫した。
             （※根本対処ではないかもしれません。まだ発生するときはご
             　連絡いただけるとありがたいです。）
            ・ファイル数が多いと、ファイルリスト生成中に停まっているか
              のように見えるため、その間はプログレスバーをマーキー表示
              するようにし、キャンセルしやすいように制御が少し戻るよう
              にした。
            ・ファイルの完全削除処理においても、タスクバーにプログレス
              を表示するように改良（Windows7のみ）。
            ・暗号化/復号処理で、データが約100MBを超える場合は、進捗(%)
              表示を小数点第一位刻みで表示するように改良。
            ・メニューや、バージョン情報ウィンドウに「最新版の確認」を
              追加。最新版リリースをサイトに問い合わせて確認できるよう
              にした。

ver.2.74     2011/01/13
            ・「暗号化パスワードを記憶する」を設定した状態で、「記憶パ
              スワードで確認なく実行する」のチェックを外していると、元
              ファイルの削除を設定していても、削除処理が行われていなかっ
              た不具合に対処。
            ・暗号化/復号処理が完了した状態で、関連付け起動、アイコン
              へのファイルのドラッグ＆ドロップしたときの処理が正常に行
              われなかった不具合に対処。

ver.2.73     2010/12/22
            ・「パスワードを記憶する」オプションを設定しても、パスワー
              ドが記憶されず、空文字で暗号化（または復号）されていた不
              具合を修正。
            ・アタッシェケースが既に起動した状態で、右クリックからのポッ
              プアップメニューにある「送る」や、関連付け起動、アイコン
              へのファイルのドラッグ＆ドロップしたときの処理が正常に行
              われていなった不具合に対処。
            ・また、動作設定から「送る」フォルダにショートカットを生成
              した際にメッセージを出すようにし、逆にショートカットを削
              除できるようにも改良した。
            ・メインフォームの「実行形式出力」のチェックボックスと、キャ
              ンセルボタンの両方に、ショートカット Alt + X が割り当てら
              れていたので、キャンセルボタンの方を Alt + C とした。
            ・暗号化でエラーが発生した際に、詳細なエラーメッセージを
              わかりやすく各所で出すように改良。

ver.2.72     2010/12/17
            ・実行形式ファイル出力が正常に行われていなかった不具合に対処。
            （リリース時のマージに失敗しておりました。ご迷惑おかけしました）

ver.2.71     2010/12/17
            ・パスワードファイルによる暗号化が行えなくなっていた不具合
              を修正。
            ・圧縮ライブラリ（zlib）をver.1.25に更新。
            ・タスクバープログレスの表示を行うようにした（Win7のみ）。

ver.2.70     2010/12/14
            ・脆弱性「バイナリ・プランティング」への対処。動作設定の
             「フォルダの場合、復号後に開く」を設定しているとき、悪意
              のある暗号化ファイルを復号すると、意図しないアプリケーショ
              ンを実行される恐れがあった。
            ・また、動作設定の「復号化したファイルを関連付けられたソフ
              トで開く」も同程度か、それ以上に危険な設定なので、チェッ
              クする場合に注意喚起するメッセージを出すようにした（あく
              まで個人使用か、信頼おける間での使用を想定しています）。
            ・動的にメモリを管理することで暗号化/復号処理の高速化を行った。
            ・ファイル毎にパスワード入力回数の制限設定ができるようになり、
              また、暗号化ファイルの自己破壊機能を追加。
            ・処理途中にキャンセルしたとき「暗号化に失敗しました」と
              出ていたメッセージを「処理が中止されました」に修正。

ver.2.69     2009/08/11
            ・ウィンドウタイトル、タスクバーに進捗表示（パーセント表示）が
              出るように改良（いつの頃からか出なくなっておりました・・・）。
            ・コマンドラインオプションから/autoname（自動で暗号化ファイ
              ル名を付加する）を指定したとき、正しく解釈が行われずエラー
              などが起きていた不具合に対処。

ver.2.68     2009/06/01
            ・前回改良を入れた、復号ファイル/フォルダのパス長制限が半角
              で255文字以内だったのを、ファイルは258文字以内、フォルダ
              は247文字以内とそれぞれで変更した（それぞれ生成する関数
              ごとに制限が異なっていたため）。

ver.2.67     2009/05/19
            ・復号するファイルまたはフォルダのパス長が、半角で255文字を
              超えるとき、メッセージもなく「生成失敗」とだけなっていた
              ところを、きちんとエラーメッセージで伝えるように改良。
            ・ver.2.65で改良し設定次第で保存先フォルダを誤って削除して
              しまわないよう入れた処理自体に不具合があり、設定によって
              は逆に元フォルダが削除されないということがあった不具合に
              対処。

ver.2.66     2009/05/07
            ・「複数ファイルは一つの暗号化ファイルにまとめる」オプション
              を選択しフォルダを暗号化すると、設定やフォルダ構成によって
              は、「ファイル生成中にエラーが発生しました！」のエラーが
              出て、復号できなかった不具合に対処。

ver.2.65     2009/04/08
            ・コマンドラインオプションに、「list」オプションを新規追加。
              別のテキストファイルで指定することで、処理するファイルを
              まとめて指定できるようにした。
            ・コマンドラインオプションから、存在しない「常に同じ場所へ
              暗号化・復号ファイルを保存する」パスを渡すと、そのオプショ
              ンが無効になっていたのを、きちんとエラーメッセージを出す
              ように改良。
            ・基本設定の「複数起動しない」をチェック、かつ「デスクトッ
              プで最前面 にウィンドウを表示する」がチェックしていない
              状態で、ファイルをアタッシェケースアイコンへドラッグ＆ド
              ロップしても各処理に移行しなかった不具合に対処。
            ・暗号化ファイルを作ろうとしている保存先を削除しようとした
              場合に、エラーを出して削除処理を中止するよう改良。
            ・これから作成する暗号化ファイル自身を暗号化しようとした場
              合に、明示的にエラーを出すように改良（今までは理由も表示
              されず、ただエラーとなっていた）。

ver.2.64     2009/03/01
            ・Windows VistaでもATCファイルの関連付けを管理者権限で実行
              できるようにプログラムを分離して、それを本体から別途呼ぶ
              ように改良した。
            ・ファイル名にUnicode文字を含むファイルを「複数で」暗号化
              しようとしたとき、警告もなくそのファイルだけ暗号化処理さ
              れないことがあった不具合に対処。
            ・「複数ファイルは１つの暗号化ファイルにまとめる」オプショ
              ンのとき、コマンドラインオプションなどから、異なる親フォ
              ルダのファイル群を暗号化しようとすると、正常に格納されな
              いことがあった不具合に対処。
            ・パスワードを記憶するオプションで、パスワード文字列によっ
              ては、まれに暗号化・復号パスワードが記憶されないことがあっ
              た不具合に対処。
            ・ヘルプファイルの「関連付け設定」などに関する記述が一部
              古いままになっていたので修正した。
            ・Windows Vistaにおいて、アクセス許可のないフォルダのファ
              イルを暗号化しようとすると、正常なエラーメッセージが出ず
              に、強制終了してしまっていた不具合に対処。
            ・XP, Vistaなどの64bit OSにおいて、出力した実行形式の暗号化
              ファイルが正常に復号できなかった不具合に対処。

ver.2.63     2008/10/25
            ・関連付け設定を起動時毎回チェックするのではなく、インストー
              ラを使ってインストールしたときのみ一回実行するようにした。
            ・それに伴い「動作設定」「システム」の関連付け設定をチェック
              ボックスからボタンUIに変更。
            ・Vistaの場合のみ、ファイルアイコンの変更や関連付けに関する
              機能すべてをインストーラで行うようにした（アタッシェケー
              ス本体からは管理者権限があっても関連付けできません）。
            ・「動作設定」「ファイルアイコンの変更」で指定した関連付け
              アイコンが正しく表示されていなかった不具合に対処。
            ・動作設定「基本」のパスワードを記憶する欄に、ファイルを
              ドラッグ＆ドロップしても、SHA-1ハッシュ値を入力できてい
              なかった不具合を修正。
            ・IISサーバから実行した時にプロセスが残るとの報告があった
              ため、自動終了する際に統一してApplication->Terminate();を
              呼ぶようにした（一部変な終了をしている箇所があったため）。
            ・暗号化ファイルを実行形式で出力する際に、必ず「4GB超え」の
              警告メッセージが出ていた不具合を修正。
            ・複数ファイルを一つにまとめるオプションで暗号化したファイ
              ルを、親フォルダを生成しないオプションで復号すると、一つ
              上のディレクトリに復号してしまっていたバグを修正。
            ・設定した暗号化ファイルの保存先フォルダ自体を暗号化すると、
              削除設定などしていた場合、予期せず削除してしまうことがあっ
              たので、事前に警告を出すようにした。
            ・「複数ファイルは一つの暗号化ファイルにまとめる」オプション
              を選択した状態で、コマンドラインからディレクトリの異なる
              ファイルを複数まとめて暗号化すると、復号時にファイル生成
              に失敗するという不具合に対処。
            ・遅ればせながらVista用のより大きなアイコン（48x48）表示に
              対応した。

ver.2.62     2008/02/26
            ・「基本設定」に「複数起動しない」オプションを追加して、
              アタッシェケースを複数起動できるように改良。
            ・Windows Vista上で、メニューなどに使われる半角カナ文字が、
              一部環境で文字化けして表示されてしまうことがあったため、
              アタッシェケースで使われる半角文字列はすべて全角に変更。
            ・Windows VistaでAero表示にしている際、Altキーを押すことで
              動作設定などのメニューが消えてしまう不具合に対処。
            ・U3ドライブから起動したときには、ファイルの関連付け設定を
              行わないようにした（動作設定からは一応可能です）。
            ・管理者権限がないなど、ATCファイルの関連付けに失敗した場
              合は、動作設定の関連付け設定のチェックを外すように改良。

ver.2.61     2008/02/07
            ・100KB 以下のファイルを暗号化すると、暗号化ファイルがすべ
              て100KB になってしまう不具合を修正。
              ※前のバージョンで100KBファイルを作ってしまったとしても、
                復号上は問題ありません。

ver.2.60     2008/02/06
            ・処理中のメモリバッファのサイズを大きくして、暗号/復号化
              の処理速度を向上させた（ただし処理するファイルサイズ、環
              境に依存します）。
            ・同様に完全削除処理の速度も向上。
            ・Vita対応の影響で、Win95/98においてのみコモンダイアログを
              表示する際、しばしば強制終了していた致命的不具合に対処。
            ・INIファイルオプションで、カレントディレクトリ以外にも、
              旧バージョンでできたアタッシェケース本体のあるディレクト
              リから読み出すようにした。

ver.2.58     2008/01/17
            ・処理によってはプログレスバーの更新が行われなかった現象に
              対処。
            ・復号後にファイルを開くオプションを設定しているとき、4つ
              以下のファイルを復号しても関連付けソフトで開かなかった不
              具合に対処。
            ・Windows98でヘルプファイル（.chm）を開こうとすると、アプ
              リケーションが強制終了してしまう不具合に対処。
            ・U3スマートドライブでヘルプファイルが開かなかった不具合を
              修正（ヘルプファイル自体が壊れていたため、正常なものに差
              し替えた）。

ver.2.57     2007/10/13
            ・U3スマートドライブにインストールされたアタッシェケース
              からヘルプファルが開けなかった不具合に対処。
            ・動作設定パネルのコモンダイアログ表示が前面に来なかった
              不具合への対処（前のバージョンアップの影響です・・・
              すみません（^^;）
            ・暗号化の際に「複数ファイルの処理」で一つにまとめる
              オプションを選択し、かつ「自動で暗号化ファイル名を付加す
              る」設定にチェックを入れていても、ファイル名を問い合わせ
              る保存ダイアログが出ていた不具合に対処。
            ・復号後のファイルが複数あったときに「復号化したファイルを
              関連付けられたソフトで開く」にチェックしていても最後に処
              理された１ファイルのみしか開かなかった不具合に対処。
            ・複数ファイルを5つ以上開く場合に、警告メッセージを表示し
              ユーザーに選択させるように改良。
            ・「複数ファイルの処理」の設定によっては「フォルダの場合、
              復号後に開く」設定を行っていても開かないことがあった不具
              合に対処。
            ・「同名ファイルがある場合に上書きの確認をする」ときの
              ダイアログに「すべて上書き」ボタンを追加した。

ver.2.56     2007/09/30
            ・Vista対応の影響で、メインウィンドウが最前面にあり、かつ
              復号時に同名ファイルがあり、上書き確認のメッセージボック
              スが表示されたときにメインウィンドウの後ろに隠れてしまう
              不具合に対処。
            ・同様にファイルをドラッグ＆ドロップしたときにメインウィ
              ンドウが前面に来なくなっていた問題に対処。
            ・ファイルを開く等のコモンダイアログ表示の際の処理を改良。

ver.2.55     2007/09/15
            ・内部で使用している圧縮ライブラリ(zlib）にセキュリティー
              攻撃の問題と、展開などの処理にバグがあったため、バージョン
              を最新のver.1.23に更新した。
            ・ヘルプファイルを.hlp→.chm形式としてWindows Vistaでも
              表示できるようにした。それに伴いヘルプ内容を見直し、
              一部改訂した。
            ・Windows Vistaにおけるタスクバー関係のアニメーションや
              プレビュー表示には一応対応。
            ・遅ればせながらビジュアルスタイルではなかった箇所（動作設
              定パネル等）をすべて対応させた。
            ・U3スマートドライブにインストールしようとするとエラーが
              発生していた不具合に対処。
            ・起動時に読み込むINIファイルオプションをアタッシェケース
              本体がある場所から、カレントディレクトリに変更。
            ・保存設定の「自動で暗号化ファイル名を付加する」設定に、
              ファイル名先頭/ファイル名末尾文字列オプションの追加。

ver.2.54     2006/10/08
            ・U3スマートドライブへのインストールに対応。
            ・ルートドライブを暗号化したとき、元ファイルの自動削除設定
              にしていると、ドライブのすべての内容が消えてしまっていた
              ため、そもそもルートドライブは丸ごと暗号化できないような
              仕様に変更した。
            ・暗号化されたフォルダを別名で復号化しようとした場合に、正
              常に新規作成して復号できていなかったバグを修正。

ver.2.53     2006/07/09
            ・基本設定に「記憶パスワードで確認なく実行する」オプション
              を追加。
            ・アタッシェケースをバージョンアップして起動した際に、イン
              ストール先が変わると、ATCファイルの関連付け設定が切れて
              しまっていたバグを修正（更新するように修正した）。
            ・「複数ファイルは一つの暗号化ファイルにまとめる」オプショ
              ンで暗号化したファイルを復号すると、まとめた親フォルダの
              タイムスタンプに不正な値が入ってしまうバグを修正。

ver.2.52     2006/06/09
            ・Win95/98系で暗号化したときに不正なタイムスタンプが入ると、
              NT/2000/XPの復号時にエラーが出て復号できなかったバグに再
              度仮対処（^^;
             （ちょっとどうしても予期しない値が入ることがあり、今回は 
               例外処理で対応することにしました。）

ver.2.51     2006/05/24
            ・実行形式ファイルで復号しようとフォルダを選択した場合、既
              にあるフォルダであっても、「新しく作成して復号しますか？」
              と問い合わせてしまっていたバグを修正。
            ・実行形式ファイル出力時に4GBを超えても警告メッセージを表
              示しないコマンドラインオプションを追加。
            ・暗号/復号処理時に無駄な処理を行っていた箇所がいくつか
              あったので修正、最適化した。

ver.2.50     2006/04/22
            ・「システム」設定の関連付けファイルアイコンの登録ダイアロ
              グで、ファイルの種類表示がおかしなことになっていたバグを
              修正。
            ・実行形式出力ファイルで復号先の指定フォルダがない場合、
              フォルダを新しく作成して復号するか問い合わせるように改良。
            ・Win95/98系で暗号化したときに不正なタイムスタンプが入ると、
              復号時にエラーが出て復号できなかったバグにとりあえず対処。
             （この場合、タイムスタンプは復号された日時となります）
            ・ファイル名にUnicode文字が含まれる場合、そのファイル名を
              エラー表示して終了するようにした（Win95/98系で復号するこ
              とも考え、Unicode文字があるファイル名では暗号化できない
              仕様としました）。
            ・同名ファイルがあった場合に、上書きする他に「別名保存」も
              選べるように改良。

ver.2.49     2005/10/10
            ・マルチモニタの環境で実行形式ファイルを起動したとき、モニ
              タの境界をまたいで、デスクトップ中央に表示されていたのを
              Primaryモニタ中央に表示するようにした。
            ・実行形式での復号中は、フォルダパス選択は無効にしておくよ
              うに改良。
            ・実行形式で保存先フォルダパスを直接入力しても、正しくその
              場所へ復号できなかったバグを修正。              
            ・暗号化/復号化パスワード記憶を設定している状態で、ウィン
              ドウメニューからファイルを開いて処理を実行しようとすると、
              改めてパスワードを聞かれてしまっていたバグを修正。

ver.2.48     2005/09/11
            ・一部のメーラー（Outlookなど）に添付されてきた暗号化ファ
              イルを直接関連付け起動することができなくなっていた現象に
              対処。
            ・すでにアタッシェケースが起動している状態で、コマンドライ
              ンから起動すると、引数を名前としたゴミファイルを生成して
              しまっていたバグを修正。

ver.2.47     2005/09/08
            ・大きいファイルを暗号化する際、ヘッダ情報書き込みのステッ
              プで止まっているように見えたのを、進捗表示を行うよう改良。
            ・コンペアの後に連続して次のファイルの処理を行った際、前の
              プログレスバー表示が残っていたのをクリアするようにした。
            ・暗号/復号処理中のパーセント表示をアプリタイトル（タスク
              バーのタイトル表示）にも行うよう改良。
            ・実行形式のファイルを復号した際、ファイルが壊れていた場合
              のエラーメッセージ表示が、正しく表示されていなかったバグ
              を修正。

ver.2.46     2005/07/17
            ・アタッシェケース本体（AtchCase.exe）のある場所のiniファ
              イルから動作設定を読み込んで起動した際に、ファイルをア
              タッシェケースアイコンへの直接ドラッグ＆ドロップしても暗
              号/復号化処理へ移行しなかったバグを修正。

ver.2.45     2005/07/11
            ・コマンドラインオプションで「/delenc=0」としても有効に
              なっていたバグを修正。
            ・コマンドラインオプションで「暗号化ファイルの拡張子を偽装
              する」を明示的にOFFできるようにした（※詳しくはヘルプ
              ファイルを参照ください）。

ver.2.44     2005/06/20
            ・保存設定の「複数ファイルは一つの暗号化ファイルにまとめ
              る」で暗号化したファイルで、かつ「復号するときに親フォル
              ダを生成しない」にチェックが入っている状態で同ディレクト
              リ内にて復号すると、同名ファイルの上書きの確認メッセージ
              が出ずに、そのまま上書きしてしまっていたバグを修正。
            ・同様の条件で、暗号化ファイルに同名ファイル（偽装などして
              拡張子も同一の場合）が格納されているとき、自身に上書きし
              ようとして復号エラーが発生してしまう現象にも対処（エラー
              メッセージで通知し処理を抜けるようにした）。

ver.2.43     2005/05/19
            ・Win95/98系でフォルダを暗号化し、WinNT/2000/XPで復号しよ
              うとすると「'0,0'は正しいタイムスタンプではない」といっ
              たエラーが発生することがあったバグを修正。
            ・実行形式ファイル内部に使わないコンペアルーチンが含まれて
              いたので整理し削除した。

ver.2.42     2005/05/15
            ・Win95/98系で保存設定の「暗号化ファイルのタイムスタンプを
              元ファイルに合わせる」にチェックを入れ、フォルダを暗号化
              すると、「'0,0'は正しいタイムスタンプではない」といった
              エラーが出てアタッシェケースが終了できなくなる致命的なバ
              グを修正。
              ※Win95/98系でフォルダを暗号化した場合は、タイムスタンプ
                は合わせない仕様とした。

ver.2.41     2005/05/14
            ・削除設定の「メインフォームにチェックボックスを表示する」
              にチェックが入っていない状態だと、設定しても削除処理に行
              かなかった凡バグを修正（^^;
            ・「メインフォームにチェックボックスを表示する」設定に関す
              る記述をヘルプファイルに追加した。

ver.2.40     2005/05/13
            ・メインフォームに処理後の「削除」を指定するチェックボック
              スを表示するようにした。それに伴って実行形式出力のチェッ
              クボックスも表示/非表示設定できるようにした。
            ・コマンドラインオプションで「暗号/復号処理かを問い合わせ
              る」（/askende）を指定した場合、正しく設定されないバグを
              修正。
            ・アタッシェケースが出力した小さいサイズの実行形式ファイル
              を復号しようとすると、まれに復号できなかったバグを修正。
            ・INIファイルで動作設定を読み込んだ際、レジストリには何も
              書き込まないはずが、"HKEY_CURRENT_USER\Software\Hibara"
              だけ書き込んでいたバグを修正。

ver.2.38     2005/05/10
            ・保存設定の「暗号化ファイルのタイムスタンプを元ファイルに
              合わせる」にチェックが入っている状態で暗号化すると、ファ
              イルのタイムスタンプが乱れてしまうか、エラーが出て処理が
              止まってしまっていたバグを修正。
            ・同じく保存設定の「タイムスタンプを復号化した日時に合わせ
              る」にチェックが入った状態で復号すると、タイムスタンプが
              ９時間ずれた状態でファイルが生成されていたバグを修正。
            ・復号化の処理でやや非効率的な部分があったので改良した。
              微妙に実行速度が向上、したと思う（^^;

ver.2.37     2005/05/07
            ・動作設定の「常に同じ場所へ保存」に直接フォルダをドロップ
              することでパスを入力できるようにした。
            ・同様に動作設定の「パスワードファイル」パスへも直接ファイ
              ルをドラッグ＆ドロップすることで入力できるようにした。
            ・コマンドラインなど実行引数指定して起動したとき、指定以外
              の動作設定をレジストリから読み込んでいなかったバグを修正。
            ・保存設定の「復号するときに親フォルダを生成しない」に、
              チェックが入っている状態で暗号時のコンペアを行うと、正常
              でもコンペアエラーが発生してしまうことがあったバグを修正。

ver.2.36     2005/04/27
            ・アタッシェケースアイコンにファイルをドロップしたり、コン
              テキストメニューからファイルを送って暗号化すると、動作設
              定が初期化されて起動されてしまうバグを修正。

ver.2.35     2005/04/25
            ・INIファイルから動作設定が読み込まれているときは、レジス
              トリへの書き込みを一切行わないようにした（今までは一部ア
              プリ情報や、ウィンドウサイズなどを書き込んでいた）。
            ・ウィンドウサイズや、位置などの記録についてもINIファイル
              へ書き込むように仕様変更。

ver.2.34     2005/04/23
            ・せっかく新規追加した機能の「INIファイル設定オプション」
              が機能していなかった凡バグに対処（^^;
            ・アタッシェケース本体（AtchCase.exe）があるフォルダを、常
              に保存する先として指定できる保存オプションを追加。

ver.2.33     2005/04/22
            ・動作設定内容を.INIファイルに書き出すオプションを追加。
              また実行ファイルや暗号化ファイルのある場所に、その.INI
              ファイルを置いておくことで、一時的な動作設定としてアタッ
              シェケースを起動できるようにした。
            ・「復号するときに親フォルダを生成しない」保存オプションを
              追加。
            ・内部で使用しているzlib圧縮ライブラリを ver.1.22に更新。
            ・極めて特殊な状態の暗号化ファイルを復号すると、ファイル末
              尾を壊してしまう致命的なバグを修正。
            ・拡張子偽装設定を行ってから、暗号化や復号化を行った際に、
              同名ファイルパスへの上書きを許し（hoge.jpg -> hoge.jpgな
              ど）、ファイルを壊していた不具合を修正。エラーを出して処
              理を中止するようにした。
            ・Win95/Win98で暗号化したファイルを復号したときに、正しく
              元のタイムスタンプが設定されていなかった不具合を修正。
            ・管理者権限でインストーラを起動しセットアップを行っても、
              スタートメニューの共通グループにショートカットが作成され
              ていなかった不具合を修正。

ver.2.32     2005/03/15
            ・コマンドラインオプションで、暗号化/復号化パスワードを設
              定せずに起動してファイルをドラッグ＆ドロップすると、勝手
              にパスワードとして "0" か "1" を入力され、暗号化されてし
              まう致命的なバグを修正。

ver.2.31     2005/03/14
            ・コマンドラインオプションで、完全削除を指定してもきちんと
              設定され起動していなかったバグを修正。またヘルプファイル
              の指定の仕方も間違っていたので、そちらも併せて修正した。
              完全削除の指定は、"/del=2", "/delenc=2"に変更した。
            ・英語版ファイル内部のバージョンナンバーが古いままだったの
              を修正した。

ver.2.30     2005/03/13
            ・現在の動作設定をバッチファイルなどのファイルへ出力するシ
              ステムオプションを追加。
            ・また、一時設定で起動している内容をメインの動作設定へ置き
              換え、保存するシステムオプションも追加。
            ・コマンドラインオプションに「パスワードにファイルの指定を
              許可する」（"/pf="）を追加。
            ・コマンドラインオプションに「常に同じ場所へファイルを復号
              化する」（"/dsaveto="）を追加。
            ・コマンドラインオプションで"/del=3"と指定して起動しても、
              完全削除が行われていなかったバグを修正。
            ・ヘルプファイルにある「起動時のコマンドオプション」で、
              「暗号化ファイルの拡張子を偽装する」の指定の記述が誤って
              いたのを修正。

ver.2.28     2005/03/11
            ・実行可能形式のインターフェースを改良し、内部処理なども少
              しだけリファイン。
            ・少し前に発表された、SHA-1の脆弱性についての記述をヘルプ
              ファイルに追加（作者として現時点では問題なしと判断）。

ver.2.27     2005/02/18
            ・暗号化/復号化パスワードの記憶で、文字列を全く入力せずに
              キャンセルで抜けた場合に、意図せず「パスワード無し」の指
              定になっていたのを抜けられないように改良。

ver.2.26     2005/02/16
            ・システム設定の「ファイルアイコンの設定」で、ユーザー指定
              アイコンを登録してもアタッシェケース終了後に登録が解消さ
              れてしまうバグを修正。

ver.2.25     2005/02/15
            ・基本設定のパスワード記憶の欄にパスワードファイルをドラッ
              グ＆ドロップした際、ファイルの種類によっては記憶できずに
              アタッシェケース自体が落ちていた致命的なバグを修正。
            ・同じくパスワード記憶のオプション指定がなく、ファイルをド
              ラッグ＆ドロップした際、パスワード入力ダイアログが出てし
              まっていたバグを修正。

ver.2.24     2005/02/13
            ・Win98系の環境で、かつ保存設定の「自動で暗号化ファイル名
              を付加する」にチェックが入っている状態だと、不正なファイ
              ルパスが生成されてしまい暗号化できなかったバグを修正。

ver.2.23     2005/02/12
            ・処理開始時に、暗号/復号処理かを問い合わせるオプションを
              基本設定に追加。また明示的に暗号/復号を指定できるコマン
              ドオプションも追加。
            ・保存設定にある暗号化/復号化パスワードの記憶メニュー部分
              に、ファイルを直接ドラッグ＆ドロップすることで、そのファ
              イルのSHA-1ハッシュ値をパスワードとして登録できるように
              した。
            ・自己解凍インストーラで、任意のイントール先フォルダを指定
              できなくなっていた（デフォルト"Program Files"固定になっ
              ていた）不具合を修正。
            ・英語版で一部、日本語が使われている部分があったので修正。

ver.2.22     2005/02/02
            ・複数ファイルを処理するときのオプションを追加。フォルダ内
              にある複数ファイルを個別に暗号/復号できるようにした。

ver.2.21     2005/01/24
            ・Explorerやデスクトップなどで、暗号化ファイル(*.atc)の上
              でコンテキストメニュー（右クリック等）を表示した際に、
              「開く」ではなく「復号化」と表示するように改良。
            ・復号時にディスクの空き容量が足りずにエラーとなった場合、
              容量不足である旨のメッセージが出るように改良。
            ・前回対処したはずだった、Win95/98上で復号する際にタイムス
              タンプ設定がうまくいかない不具合に、今度こそ対処（^^;
            ・特殊フォルダ、特定のボリュームラベルのドライブを、常に保
              存する先として指定できるオプションを追加。
            ・それに伴って指定された保存先が見つからない場合は、エラー
              メッセージを出して処理を中止するように仕様変更。

ver.2.20     2004/11/01
            ・「指定のパスワードファイルを自動チェックする」にチェック
              が入っている状態で、パスワードを間違えて復号が失敗した後、
              正しいパスワードを入力しても、復号に失敗していた不具合に
              対処。
            ・またパスワードファイルを間違えて失敗した後に、正しいパス
              ワードファイルをドラッグ＆ドロップしても復号に失敗してい
              た不具合に対処。
            ・パスワードファイルの自動チェックを、暗号時と復号時に分け
              て設定できるように新しく機能追加。
            ・Win95/98上で復号する際に、タイムスタンプ設定がうまくいか
              ず、正しく復号することができなかった不具合に正式対処。

ver.2.18     2004/10/28
            ・コマンドラインオプションで、ネットワーク上にあるフォルダ
              を指定して暗号化しようとした場合に「フォルダが見つかりま
              せん」といったメッセージが出て、暗号化できなかった不具合
              に対処。

ver.2.17     2004/10/20
            ・Win95/98上で復号する際に、タイムスタンプ設定がうまくいか
              ず、正しく復号することができなかった不具合に対して仮対処。
              ※現在、作者がWin98系での動作確認が行えない状態なので、
                仮に以前のタイムスタンプを設定しない復号を行う仕様に戻
                した（Win95/98系のみ）。

ver.2.16     2004/10/18
            ・復号時のパスワードを記憶した状態で、異なるパスワードの暗
              号化ファイルの復号に失敗すると、パスワードの再入力を促さ
              れるが、そこで正しく入力し直してもきちんと復号されなかっ
              た不具合に対処。

ver.2.15     2004/10/15
            ・「保存」の「複数ファイルは一つの暗号化ファイルにまとめ
              る」オプションにチェックしている状態で、実行形式で出力し
              ようとすると、デフォルトで".atc"の拡張子になっていた不具
              合を修正。
            ・英語版で「ファイルを開く」などのコモンダイアログのタイト
              ル各所が、英語表記になっていなかったのを修正。

ver.2.14     2004/10/06
            ・「暗号化ファイルのタイムスタンプを元ファイルに合わせる」
              保存オプションを追加。
            ・復号時に、フォルダのタイムスタンプもきちんと復元されるよ
              うに改良した（今までは新規作成扱いで復号された時点のタイ
              プスタンプになっていた）。ただし、NT/2000/XP系のみ。
            ・通常削除、完全削除の際に、フォルダが「隠しファイル」「読
              み取り専用」属性になっていると、まれに削除できずに残って
              しまっていた不具合に対処。
            ・暗号化/復号処理中は上部メニューにアクセスできないように
              改良。

ver.2.13     2004/10/03
            ・実行形式出力（*.exe）を行った際、拡張子偽装オプションを
              設定していると、コンペアに失敗していた不具合に対処。
            ・拡張子偽装オプションで「.exe」を指定して作成した暗号化
              ファイルをアタッシェケースにドラッグ＆ドロップしても、正
              しく復号処理に移行しなかった不具合に対処。

ver.2.12     2004/10/02
            ・実行形式出力（*.exe）を行った場合に、拡張子偽装オプショ
              ンが機能していなかった不具合に対処。

ver.2.11     2004/09/29
            ・WindowsXPのビジュアルスタイル以外での環境で起動すると、
              ウィンドウ上部メニューの表示が乱れてしまっていた不具合に
              対処（※前のバージョンでデザイン改良した影響です）。
            ・ヘルプファイルの一部記述を修正、追加。
            ・メインアイコンをちょっとだけ色調整。

ver.2.10     2004/09/23
            ・復号の際のパスワード入力ミスを三回まで許し、再入力を促す
              ように改良。
            ・名前にピリオド "." が含まれているフォルダを暗号化した際
              に、拡張子の解釈がうまくいかず、ピリオド以下の文字列が消
              えて暗号化ファイルを生成していたバグを修正。
            ・ヘルプファイルの「使用条件・免責」のページを追加。
            ・フォームデザインを少しだけ改良。

ver.2.09     2004/08/22
            ・ファイルサイズ、初期化ベクトルデータの配置、圧縮率の状態
              によって、まれにファイルが復号できずにzlibエラーを返す不
              具合に対処。
            ・コンペア中にエラーが発生した場合は、暗号化ファイルを削除
              しないようにした。
            ・復号先にすでに同名ファイルが存在し、かつ属性が読み取り専
              用、隠しファイルであったとしても、上書き確認をしていれば
              そのまま上書き処理してしまうように改良（今まではエラーが
              表示され処理を中止していた）。

ver.2.08     2004/08/13
            ・読み取り専用のファイルを暗号化して、コンペアをした場合に、
              エラーが発生し正常終了しない場合があったのを一応対処。
            ・また、コンペア中にエラーで抜けた際、内部的にファイルが
              アタッシェケースによって開かれたままになっていたのを修正。
            ・元ファイルが読み取り専用になっていると、正常に削除処理が
              行えなかった不具合に一応対処。
            ・完全削除処理の中で、一部エラー処理がきちんと働いていな
              かった箇所を修正。

ver.2.07     2004/08/09
            ・ショートカットファイルにコマンドラインオプションを指定し
              て、ファイルをドロップした場合に、パスワードファイルのパ
              スをうまく認識できなかった不具合に対処。
            ・動作設定パネルの挙動（パス表示を末尾に合わせる等）を少し
              だけ改良。

ver.2.06     2004/08/08
            ・「自動で暗号化ファイルを付加する」の設定が正しく機能して
              いなかったバグを修正。
            ・ヘルプファイルの「起動時のコマンドオプション」の中で、引
              数"autoname"の説明がまちがっていたのを修正。
            ・暗号化、復号化の後で、元ファイル/暗号化ファイルを削除す
              るかを個別に指定できるようにした。

ver.2.05     2004/08/07
            ・上部メニュー「終了」から終了できなかったバグを修正。
            ・特定の状況でフォルダに入った複数の圧縮ファイル（.lzh等）
              をver.1で暗号化してから、ver.2で復号しようとすると、
             「zlibエラー:-5」が発生し戻せなかった不具合に対処。

ver.2.04     2004/08/04
            ・ファイルサイズが小さく、ファイル末尾が特殊な状態になって
              いると復号できないことがあったバグを修正（※暗号化ファイ
              ルが壊れているわけでなく、復号ルーチンのバグです）。
            ・通常の暗号化ファイル（*.atc）において、パスワードファイ
              ルが機能しておらず、NULL（空文字）として入力されていたバ
              グを修正。
            ・また、旧バージョン（ver.1.**）で、パスワードファイルによ
              り暗号化したファイルが戻せなかったバグを修正。

ver.2.03     2004/07/31
            ・実行形式で出力した際に、パスワードファイルを受け付けな
              かった不具合に対処。
            ・また、実行形式ファイルに「フォルダ」をドロップした場合に、
              フリーズしていた不具合にも対処。

ver.2.02     2004/07/30
            ・パスワードが入力できなくなっている問題に対処。
              毎度毎度お騒がせしております、はい・・・（^^;

ver.2.01     2004/07/29
            ・実行形式出力したファイルが復号できないバグを修正。
              毎度、凡バグですみません・・・（^^;
            ・復号時のときはパスワードの文字制限をかけないようにした。
              （Blowfishで暗号化されたファイルの場合があるのと、不要か
              と思われるため）

ver.2.00     2004/07/25
            ・暗号化アルゴリズムをBlowfishから、より強力なRijndaelへと
              変更した。それに伴って、初期化ベクトル（IV）を生成してか
              ら、CBCモードで暗号化するように改良。第三者による暗号化
              特徴からの解析をされにくくした。
            ・それにより内部的なデータバージョンを上げた。今バージョン
              で暗号化したファイルは、以前のバージョンでは復号できなく
              なったので注意（※その逆は上位互換なので問題なし）。
            ・パスワードファイルの先頭データからパスワードを抽出する仕
              様から、SHA-1のメッセージダイジェストを使う仕様に変更。
            ・ファイルコンペア機能を追加。暗号化した後に、元データとコ
              ンペアすることで、正しく復号できるかどうかをチェック可能
              にした。
            ・アタッシェケースファイルのアイコン（関連付けアイコン）を
              任意に変更できるようにした。
            ・動作設定のいくつか（すべてではない）をコマンドラインオプ
              ションとして指定実行できるようにした。
            ・メジャーバージョンアップということで、アプリアイコン、
              フォームデザインを一新（単なる自己満足です♪）。
            ・タイムスタンプが奇数秒のファイルを暗号化/復号した際に、
              偶数秒に丸められていたバグを修正。

-----------------------------------

ver.1.46     2004/07/25
            ・「暗号化ファイル名に拡張子を含める」と「自動で暗号化ファ
              イル名を付加する」にチェックを入れ "<filename>" のみにす
              ると、暗号化に失敗し、元ファイルが削除されてしまうバグを
              修正。
            ・前述の設定の組み合わせによっては、一部機能しないことが
              あったので、「自動で暗号化ファイル名を付加する」設定の優
              先度を上げることにした。
            ・その他、細かい改良。

ver.1.45     2004/07/01
            ・復号時に、特定の条件が揃うと、終端の1byteに異なるデータ
              を書き込んでしまっていたバグを修正。
            ・前バージョンで仮処置したzlibからCRCチェックエラーが返さ
              れる問題について、原因がわかったので根本対処した。

ver.1.44     2004/06/04
            ・内部で使用しているzlibライブラリが、データによっては
              ごくまれにCRCチェックエラーを返し（謎です・・・調査中）、
              復号できなかったのを、途中停止しないよう最後まで処理する
              ようにした。
             （※データ自体は問題なく復号できるので、zlibエラーが出た 
                 場合のみ、復号完了後にエラーメッセージを出すようにした）。
            ・復号化最中にエラーが発生した際、暗号化ファイルを内部的に
              きちんとクローズして抜けていなかったのを修正。

ver.1.43     2004/03/24
            ・アイコンに複数ファイルをドラッグ＆ドロップしたときや、コ
              ンテキストメニューの「送る」へファイルを送ったときに、う
              まく暗号/復号処理できていなかったバグを修正（最近の改良
              で仕込んじゃったようです、すみません・・・）。
            ・「完全削除」のゼロ書き込み、乱数書き込みの両方が機能して
              おらず、サイズ0にしていただけだった凡バグを修正（こちら
              も最近仕込んだようです・・・）。

ver.1.42     2004/03/15
            ・前バージョンの修正に伴い、旧バージョンでパスワードファイ
              ルを使って暗号化したファイルが、復号できない場合があった
              のに対処。

ver.1.41     2004/03/14
            ・Blowfishのパスワード長の制限が56バイトのため、予期せぬ値
              が入らないように修正した（今更ですがすんません…）。
              ※なので「パスワードファイル」も255バイトではなく、今後
                は56バイトしか入りません（^^;

ver.1.40     2004/03/09
            ・コマンドラインオプションで、相対パスで指定されると、ファ
              イルが見つからず、暗号化（または復号）できないことがあっ
              たバグを修正。
            
ver.1.39     2004/03/02
            ・同名ファイルへ上書きして暗号化した際に、エラーが発生し処
              理を抜けたときのみ、先にあった暗号化ファイルを壊してしま
              うことがあったのを回避するよう改善。

ver.1.38     2004/02/24
            ・「常に自己実行形式で出力する」オプションを基本設定に追加。
            ・圧縮が効きやすく、特定のサイズのファイルを暗号化した際、
              まれに誤った形で格納され、復号化した際にデータ末尾が壊れ
              るか、切れてしまう致命的なバグを修正。

ver.1.37     2004/02/19
            ・パスワード入力ボックスにフォーカスがあるときは、「貼り付
              け」などのコンテキスト（ポップアップ）メニューを表示する
              ようにした。
            ・末尾に大量の空フォルダが連続して格納された暗号化ファイル
              を復号化しようとすると、インデックスエラーが出て、アタッ
              シェケースが終了できなくなるバグを修正（※ただし、データ
              は正常に復号化されているようでした）。

ver.1.36     2004/02/14
            ・自己実行形式で復号化する際、保存先を指定できるようにした。
            ・前バージョンにて制限ユーザー時のレジストリ書き込みの不具
              合を修正した関係で、関連付け設定が一部有効にならなくなっ
              てしまっていたバグを修正。
            ・属性が読み取り専用のファイルを復号化したとき、タイムスタ
              ンプが作成時となってしまっていたバグを修正。
            ・「キャンセル」「閉じる」ボタンの名称を各ステップでそれぞ
              れ変更。また通常フォームでのボタンは「終了」としてみた。

ver.1.35     2004/02/03
            ・「保存」設定に「自動で暗号化ファイル名を付加する」機能を
              追加。ファイル名に日時や連番を振ったり、ランダムな文字列
              等で名前を自動付加できるようになった。
            ・それに伴って動作設定パネルのレイアウトを少し整えた。
            ・Windows2000/XPなど制限ユーザーでログオンし使用した場合に、
              レジストリ書き込みエラーとなり、まったく起動しなかった致
              命的なバグを修正。

ver.1.34     2003/12/27
            ・4GBを超える実行形式ファイルを生成してしまうと、Win32アプ
              リケーションとして実行できなくなるので（Windowsの仕様）、
              暗号化ファイルを作成する前と、処理中4GBを超えるときに、
              メッセージで問い合わせるようにした。
              ※通常の*.atcファイルは問題ありません。
            ・巨大ファイルを暗号/復号/削除処理する際、長らく制御が戻ら
              ずキャンセルなどしにくかったのを改善。
            ・質問が多かったのでヘルプファイルに「制限」の項目を追加。

ver.1.33     2003/12/20
            ・完全削除のゼロ書き込み削除の際に、プログレスバーが描画さ
              れなかったバグを修正（なぜ今まで放置されていた？（^^;))。
            ・暗号/復号と完全削除でプログレスバーの色を替えるようにし
              てみた。

ver.1.32     2003/11/24
            ・起動時のコマンドオプションとしてパスワード（文字列のみ）
              を指定できるようにした。

ver.1.31     2003/11/23
            ・暗号化時と、復号時のパスワードを分けて記憶できるようにし
              た。また、記憶パスワードが他のツール等で読み取られないよ
              うに少しだけ工夫して管理。
            ・高度な設定で「パスワードファイルの指定許可」をチェックし
              てなくても「自動チェックする」にチェックがあると、勝手に
              自動チェックしに行っていたバグを修正。
            ・複数のファイルを暗号化する際、パスワードの自動チェック設
              定をしていると、一ファイルごとにパスワードファイルを読ん
              でしまっていたのを最初の一回だけに修正。
            ・自己実行可能形式で出力した際に、バージョン情報の内容が消
              えていた不具合に対処（※動作的には全く支障ありません）。

ver.1.30     2003/11/09
            ・高度な設定としてパスワードファイル機能を新しく追加。
            ・高度な設定として拡張子偽装設定を新しく追加。
            ・ネットワーク上のファイルを暗号/復号化しようとするとエ
              ラーになり、処理を実行できなかったバグを修正。
              ※但し、Win95 OSR2以前では修正されず機能しません。あしか
                らず。

ver.1.25     2003/10/05
            ・暗号化ファイルに格納するファイル種類と順序によっては、
              zlibエラーを返し、復号データの末尾が切れるバグを修正。圧
              縮のききにくいファイルがデータ末尾に格納されると、まれに
              発生していた模様。
            ・その他、自己実行可能形式出力周りの細かいバグ修正＆リファ
              イン。

ver.1.24     2003/09/21
            ・ファイルサイズによっては復号化できなかったバグを修正（何
              度もスミマセン・・・（^^;））。
            ・出力した実行可能形式ファイル（*.exe）をアタッシェケース
              にドロップする（または開く）ことでも復号化できるようにし
              た。

ver.1.23     2003/09/13
            ・暗号化されたフォルダの中に、ファイルサイズが小さく（64バ
              イト以下）かつそれらが複数ある状況で、一番最後にサイズの
              小さなファイルを復号化しようとするとzlibエラーが発生し、
              復号できなかったバグを修正。
            ・「暗号化ファイル名に拡張子を含める」オプションを追加。
            ・動作設定パネルの正しくなかったタブオーダーを修正。

ver.1.22     2003/09/08
            ・Win9x系で、作成した自己実行形式ファイルを復号しようとす
              ると「ファイルを開くことができません！‥‥」云々といった
              エラーが出てしまっていた凡バグに対処。今度こそ大丈夫なは
              ず。それしてもダメダメですみません‥‥（泣）

ver.1.21     2003/09/07
            ・Win9x系で、自己実行形式出力しようとすると、「ファイルを
              開くことができません！‥‥」云々といったエラーが出て、生
              成できていなかった凡バグに対処。

ver.1.20     2003/09/06
            ・自己実行形式出力に対応。アタッシェケースのない環境でも暗
              号化ファイルを渡して、復号できるようになった。

ver.1.12     2003/08/28
            ・プログレスバー表示をオリジナルで描画することにした。
             （※サイズを小さくするため、自己実行形式出力への布石です。）

ver.1.11     2003/08/23
            ・暗号化におけるファイルリスト生成処理の最適化を行った。
              数の多いファイルを処理する際の処理速度が向上。
            ・復号化においるファイルリスト生成処理の最適化を行った。
              数の多いファイルを含む暗号化ファイルを復号する際の速度が、
              大幅に向上した（今までが重すぎでした（^^;））。
            ・大量のファイルを処理していると止まっているかのように見え
              ていたので、処理過程を表示するように改良。
            ・他アプリで使用中のファイルを含むフォルダを無理やり暗号化
              した際に、予期せぬエラーを引き起こしていたのを改良。きち
              んとエラー処理して抜けるよう対策を施した。
            ・Windows95での動作保証とサポートを終了した。（※詳細は
              「動作環境」の項目を参照ください。）

ver.1.10     2003/08/04
            ・削除設定を「ごみ箱への削除」にしていた際に、処理したファ
              イルやフォルダがすぐに表示されないことがあったため、念の
              ため毎回フォルダ内の表示更新を行うようにした。
            ・ごみ箱への削除に失敗した場合、エラーメッセージを表示する
              ようにした。

ver.1.091    2003/07/17
            ・誤って関連付け設定を切ってしまい、機能していなかったバグ
              を修正（^^;

ver.1.09     2003/07/16
            ・国際化対応を行った。とりあえず「英語（U.S）」だけにロー
              カライズを行った。（※将来的には多言語に対応可能）
            ・メインウィンドウの最大化も含めたリサイズを可能にした。
            ・完全削除を行った際のプログレスバー表示で、回数分まとめて
              表示していたのを分かりやすく回数ごとの表示に変更。
            ・パスワード入力をまちがえたときにエラーが出て落ちていた致
              命的なバグを修正（巨大ファイル処理改良時の影響です）。
            ・復号化で特定な操作を行うことでファイルが内部的に開いたま
              まとなり、正常に復号処理が行えないことがあったバグを修正。
            ・メインウィンドウの「記憶する」チェックボックスの挙動を少
              し改良。

ver.1.08     2003/6/23
            ・暗号/復号化する際、まれに前のメッセージがメインウィンド
              ウ上に残ったり、正しく表示されていなかったバグを修正。
            ・4GBを越える巨大ファイルを復号化する際、ファイルサイズが
              取得できず、復号化できないことがあったバグを修正。
             （※Win2000/XPで、かつファイルシステムがNTFSの場合のみ）
            ・同様に4GBを越える巨大ファイルを処理する際プログレスバー
              およびパーセンテージ表示が乱れてしまっていたバグを修正。
             （※Win2000/XPで、かつファイルシステムがNTFSの場合のみ）
            ・メインウィンドウのパスワードを「記憶する」チェックボック
              スが、有効になっていなかったバグを修正（いつの間に？）。
            ・以前修正したが、Explorerなどからアタッシェケースファイル
              （*.atc）を複数開いた際に、まれに一部だけファイルが復号
              化されずに残ってしまうのに対処。けっこうシビアなタイミン
              グで処理しているので、完全には対処できないかも。
            ・常に同じ場所へファイルを復号化する設定を行っている際に、
              元ファイルのある方のディスクの空き容量チェックを行ってし
              まっていたバグを修正。
            ・遅ればせながらWindowsXPのビジュアルスタイルに対応（^^;

ver.1.07     2003/06/08
            ・関連付け設定と、削除設定のゼロ書き込み設定が正常に記憶さ
              れないことがあり、正しく設定が反映されないバグを修正。
            ・「複数ファイルは一つの暗号化ファイルにまとめる」で、完全
              削除などを行ったとき正常に削除できず、場合によっては不正
              な処理になっていた致命的バグを修正。
            ・完全削除中のプログレスバーが正しく表示されていなかったバ
              グを修正。
            ・その他、細かい内部的な修正など。

ver.1.06     2003/06/04
            ・動作設定の「保存設定」→「複数ファイルは一つの暗号化ファ
              イルにまとめる」をチェックして、元ファイルのある場所以外
              へ暗号化ファイルを作成すると、復号化できなくなるという致
              命的なバグを修正（※十分にテストしたのですが・・・面目あ
              りません（^^;））。
            ・常に同じ場所へファイルを復号化するオプションを追加。

ver.1.05     2003/06/03
            ・「常に同じフォルダへ暗号化ファイルを保存する」設定で、
              フォルダ選択ダイアログを出したとき、メインウィンドウが前
              面に出てきて邪魔していたバグを修正。
            ・単体ファイルなど、復号化した際、暗号化する前のタイムスタ
              ンプに正しく設定できないことがあったバグを修正。
            ・Windows9x系で、かつ一部の環境によっては、うまくatcファイ
              ルの関連付け設定が行われないというバグの原因らしき箇所を
              修正してみた（※当方の環境では確認不可）。
            ・同じくWindows9x系でアイコンへファイルをドラッグ＆ドロッ
              プしたり、関連付け起動した際に短いファイル名（MS-DOS形
              式）に変換されてしまい、正常に暗号/復号化できなくなって
              いた大バグを修正。
            ・暗号/復号化の最中にキャンセルした際、一部ファイルを閉じ
              ずに中止していたため、連続して再処理を行うとエラーが出て
              処理が行えないバグを修正。
            ・復号化の際のプログレスバーの表示が不正確だったバグを修正。
            ・暗号化ファイルと、その元ファイルを一緒にドラッグ＆ドロッ
              プすると予期せぬエラーが出ていたバグを修正（※きちんとエ
              ラー処理して抜けるようにした）。
            ・Explorerなどで複数の暗号化ファイル（*.atc）を選択し実行
              したとき、一つのファイルしか復号化されなかった仕様を改良
             （※バグではなくWindowsの仕様だったようです）。
            ・この仕様改良に伴い、パスワード入力中のウィンドウキャプ
              ションに処理中のファイル名が表示されていた仕様を削除。
            ・複数ファイルを処理する際、一つの暗号化ファイルにまとめる
              オプションを追加。
            ・復号化したファイルを関連付けされたアプリケーションで自動
              オープンするオプションを追加。
            ・復号化したファイルのタイムスタンプを作成時に合わせるオプ
              ションを追加。
            ・削除設定でWindowsの「ごみ箱」への移動オプションを追加。
            ・これらのオプション追加に伴い、設定パネル項目の整理を行っ
              た（※順番やタブ分けが変わっただけで以前の設定はそのまま
              受け継がれます）。
            ・その他、細かい修正＆改良。

ver.1.04     2003/05/10
            ・パスワードに「aaaaaa」や「abcabc」など、繰り返しで、かつ
              偶数文字で設定すると、繰り返し文字単位（「a」や「abc」）
              の入力だけで、復号化できてしまうバグを修正。
              ※それにより、内部的なデータバージョンが上がり、今バー
                ジョンのアタッシェケースで暗号化されたファイルは、旧
                バージョンで復号化できなくなりました。ご注意ください。
            ・この修正に伴い、パスワード入力において「空白（無記入）」
              にしても暗号／復号化できるような仕様に改良。
              ※ただし、空白のパスワードは「記憶」できない仕様のままに
                した（セキュリティーを考慮して）。
            ・複数のファイル／フォルダをドラッグ＆ドロップして暗号化す
              ると、ドロップしたすべてのファイルを１ファイルに格納して
              いってしまう大バグ（凡バグとも言う（^^;ゝ）を修正。
            ・アタッシェケースを起動中に、関連付けられた暗号化ファイル
              をダブルクリック、またはアイコンへファイルをドラッグ＆ド
              ロップしても処理移行しなかったのを修正。
            ・「処理後、アタッシェケースを終了する」にチェックを入れ、
              暗号・復号化処理をすると、「無効/非表示ウィンドウには
              フォーカスを設定できません」といったエラーが出ていたバグ
              を修正。
            ・同様の不具合で「動作設定」のパスワード設定入力ボックスで、
              無記入のままEnterキーを押すと、同じエラーメッセージが出
              ていたバグを修正。
            ・パスワード入力ボックスで、EnterキーやEscキーを押すたびご
              とにBeep音が鳴っていたのを消去するようにした。
            ・処理中、制御が戻る間隔を少しだけ短くした（プログレスバー
              の伸び方などが少しだけ滑らかになった）。
            ・メニューの「暗号／復号化するファイルを開く」をそれぞれ、
              「暗号化するファイルを開く」と「復号化するファイル」に分
              けた。

ver.1.03     2003/05/02
            ・一部の内部アイコンが壊れていたため、関連付けても鍵マーク
              アイコンが表示されなかったバグを修正。
            ・処理後、キャンセルボタンにフォーカスが移るように改良。

ver.1.02     2003/05/01
            ・動作設定ウィンドウでタブオーダーがおかしくなっていた部分
              を修正。
            ・環境によってはアタッシェケースのウィンドウが意図しない形
              のサイズになっていたバグを修正。
            ・処理後、いったんキャンセルしないとファイルのドラッグ＆ド
              ロップを受けつけなかったのを、処理が完了していれば連続し
              て受けつけることができるように改良。
            ・自動終了設定をしていれば、ユーザーキャンセルやエラーが発
              生した場合であっても、そのまま自動終了していたが、その場
              合のみしないように改良。
            ・"*"文字で隠さず、パスワードを確認しながら入力できる設定
              を追加。
            ・暗号/復号処理中のファイル名を、ウィンドウキャプションに
              表示するようにした。

ver.1.01     2003/04/19
            ・暗号/復号化ボタンを押して、ダイアログからファイルを選択
              しても、暗号/復号処理できなくなっていたバグを修正。

ver.1.00     2003/03/31
            ・正式公開版としてリリース。
            ・動作設定パネルのパスワード入力の際に、無記入で記憶できて
              しまうバグを修正（これで暗号化すると落ちてました（^^;））。
            ・暗号化ファイルに含めるファイルリストに無駄なタブ文字が含
              まれていたので省いてちょっとだけサイズを小さくした。
            ・ルートに置いてある暗号ファイルを復号化した際、うまく
              Explorerへ渡せず、「復号後に開く」の設定が有効にならな
              かったバグを修正。

-----------------------------------

ver.0.07β   2003/03/24
            ・指定の保存先が削除されるなど、無くなっていた場合に、正常
              に暗号化ファイルを作れなかったバグを修正。
            ・ログを残すなど、すべてのデバッグ機能を外し、正式公開へ向
              けての最終デバッグ開始。

ver.0.06β   2003/03/16
            ・ファイルが一つも入っていない状態で、深い階層にしたフォル
              ダを暗号化すると、正常に動作しなかったバグを修正。
            ・関連付け設定を切っても、起動時に関連付けられてしまうので、
              オプション設定を行った場合に限り、それをキャンセルするよ
              うにした。
            ・全角で127文字を超えるようにIME変換して一気にパスワード入
              力すると、エラーメッセージが超えた文字数分だけ出てしまう
              バグを修正（^^;ゝ
            ・ディスクの空き容量をチェックして、いっぱいになったときは
              処理をはねるようにした（エラーを出してキャンセルされるよ
              うにした）。
            ・それに伴って4GBくらいまでのファイルしか扱えなかったのを、
              それ以上の巨大ファイル処理にも対応（そんなの暗号化するか
              どうかはともかくとして）。
            ・暗号／復号化した際に、同名ファイル（またはフォルダ）が
              あった場合、上書き確認のメッセージがいつの間にか出なく
              なっていたバグを修正（^^;

ver.0.05β   2003/03/10
            ・素っ気ないデザインからグラフィカルなデザインに変更（笑）
            ・テンポラリファイルを使わずにすべてメモリ上で、圧縮→暗号
              の処理（または復号→解凍処理）を行うようにした。そのおか
              げでセキュリティーも向上。
            ・解凍した際に、元ファイルの属性やタイムスタンプを記憶して
              いなかったのを、きちんと再現できるようにした。
            ・関連付け起動して復号化した際に「フォルダを開く」設定が利
              いていなかった不具合を修正。
            ・メインウィンドウをデスクトップで常に最前面にする機能オプ
              ションを追加した。
            ・「送る」フォルダへショートカットを作るオプションを追加。
            ・ヘッダが壊れている状態で、暗号化ファイルを読み込ませると、
              暗号化処理に移行してしまうのをエラーが出るように改良。
            ・エラーが発生したとき、まれにメッセージ表記が重なって乱れ
              てしまう不具合を修正。
            ・ファイルリストの持ち方などに変更を加えたため、内部的な
              データバージョンを上げた。（1.0.1→1.0.2）

ver.0.04β   2003/01/07
            ・動作設定パネルの「関連付け設定の解除」のボタンが有効に
              なっていなかった凡バグを修正。
            ・アーカイバDLLを使った圧縮機能を廃し、フリーライブラリの
              zlib圧縮を使って、独自処理するように大改造。
            ・それにより、環境によってDLLがないなどの複雑なエラー処理
              を行う必要がなくなり、関連バグもなくなった。
            ・また、圧縮方法の変更に伴いATCファイルデータ構造を変更し、
              内部的なデータバージョンを上げた。（1.0.0→1.0.1）
            ・オプションで、常に指定の場所（フォルダ）へ暗号化ファイル
              を生成できるようにした。
            ・完全削除の初期設定を、乱数は0回、NULL値は1回という設定に
              した（あまりにも処理に時間がかかるため）。
              ※もちろん後からユーザーが変更できます。
            ・復号化した際に、フォルダだけではなく、１ファイルのときも
              同名ファイルがあれば、上書きの確認を行うようにした。

ver.0.03β   2002/12/26
            ・「閉じる」ボタンを追加。
            ・処理実行中以外は「中止」ボタンを無効にしておくようにした。
            ・アイコンへ直接ファイルをドラッグ＆ドロップする処理が利い
              ていなかったバグを修正。
            ・暗号／復号化処理後に、完了メッセージを表示するようにした。
            ・フォルダ内に１つもファイルがない場合、ただ処理中止をして
              いたのを、きちんとエラーメッセージ表示するようにした。
            ・復号化した先に同名ファイルがあると、連番を付加して上書き
              してしまうバグを修正。
            ・設定したアーカイブの種類によっては、復号化したときに「圧
              縮DLLがありません」というメッセージが出て、処理が行えな
              かったバグを修正。

ver.0.02β   2002/12/18
            ・処理途中で中止できるようにした。
            ・また処理中、強引に終了させても正常に終了するように改良。
            ・同名のアーカイバファイルがあると、正常に復号化できなかっ
              たバグを修正。
            ・同様に、同名フォルダがある場合に、無条件で上書きしていた
              処理をユーザーに問い合わせするようにした。
            ・ヘルプファイルを大幅に改編。

ver.0.01β   2002/11/13
            ・非公開でベータテスト版リリース（ごく一部の人だけに公開）



以上

