<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<head xmlns="http://www.w3.org/1999/html">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="stylesheet" type="text/css" href="css/help.css" />
	<title>起動時のコマンドオプション</title>
</head>
<body>

<h1>起動時のコマンドオプション</h1>

<p>
「起動時のコマンドオプション」が何のことか分からないユーザーさんには、まったく関係ありません。
読み飛ばしてください。</p>

<p>
このページでは、アタッシェケースをより高度に使いこなしたい人向けに、カスタマイズの方法を説明しています。
</p>

<p>
アタッシェケースでは、起動時に引数を渡すことで、暗号/復号化処理を行うことが可能です。
他のアプリケーションから扱ったり、バッチファイルなどから操作できます。
たとえば、アタッシェケースのショートカットを作成し、
「リンク先」に書き込むことでパスワードを使い分けて暗号/復号するなんて使い方も便利かもしれません。
</p>

<div class="notice">
ただ、この使い方は、パスワード文字列は隠されることなくそのまま記録、
表示されることになるので、設定は十分注意して行ってください。 あくまでこれも自己責任でお願いします。
</div>

<div class="info">
注意点
<ul>
<li>
特に引数を指定しない場合は、すでに設定されている内容でアタッシェケースは起動します。<br />
たとえば「フォルダの場合、復号後に開く」の設定にふだんはONにしていると、引数でOFFと特に指定しないかぎり、
復号後にフォルダを開く動作となります。
</li>
<li>
引数の大文字小文字は区別しません。ただし、パスワードなど設定の中身は区別します。<br />
引数と"="（イーコール）の間に空白やTabなどの制御文字を入れると正しく認識できません。
</li>
<li>
設定内容のパスワードに空白を入れたり、ファイルパスに空白が含まれる場合は、
""（ダブルコーテーション）で引数全体を括ると正しく認識できます。
</li>
<li>
コマンドライン引数を指定して実行した場合は、終了時にその設定を保存しません。
ユーザーキャンセルなどで処理を中止した際に、改めて動作設定を行っても反映されません。
</li>
<li>
アタッシェケースが出力した実行形式（*.exe）ファイルの暗号化ファイルに対して、
コマンドラインでの指定はできません。<br />
できるのは本体（AtchCase.exe）へのみです。
</li>
<li>
コマンドラインオプションでアタッシェケースのすべての設定項目を指定できません
（一部設定できないものもあります）。
</li>
</ul>
</div><br />

<br />

<p>設定できる項目は以下の通りです。</p>


<h2>基本設定</h2>

<div class="paragraph">

<p>
<strong>/p=[PASSWORD]</strong><br />
パスワード<br />
ex). /p=hirakegoma ※パスに空白を含む場合は、ex). "/p=hirake goma"<br />
</p>

<p>
<strong>/mempexe=[0,1]</strong><br />
記憶パスワードで確認なく実行する<br />
ex). /mempexe=1 ※実行せず確認を行いたい場合は、ex). /mempexe=0<br />
</p>

<p>
<strong>/wmin=[0,1]</strong><br />
常にウィンドウを最小化して処理する<br />
ex). /wmin=1 ※常に最小化して暗号化/復号処理を行いたくない場合は、ex). /wmin=0<br />
</p>

<p>
<strong>/tskb=[0,1]</strong><br />
ウィンドウを最小化したときタスクバーに表示しない
ex). /tskb=1 ※表示しておきたい場合は、ex). /tskb=0<br />
</p>

<p>
<strong>/tsktr=[0,1]</strong><br />
タスクトレイにアイコンを表示する<br />
ex). /tsktr=1 ※アイコンを表示したくない場合は、ex). /tsktr=0<br />
<div class="info">注意点<br />
<blockquote>「ウィンドウを最小化したときタスクバーに表示しない」オプション（/tskb）と
「タスクトレイにアイコンを表示する」オプション（/tsktr）の両方をOFF（=0）にすることはできません
（アタッシェケースを操作できる場所がなくなってしまうからです）。<br />
ただ、もし両オプションを設定してしまった場合は、強制的に<strong>「タスクトレイにアイコンを表示する」</strong>がONになります。
</blockquote>
</div>
</p>

<p>
<strong>/opd=[0,1]</strong><br />
フォルダの場合、復号後に開く<br />
ex). /opd=1 ※フォルダを開きたくない場合は、ex). /opd=0<br />
</p>

<p>
<strong>/opf=[0,1]</strong><br />
復号したファイルを関連付けられたソフトで開く<br />
ex). /opf=1 ※フォルダを開きたくない場合は、ex). /opf=0<br />
</p>

<p>
<strong>/exit=[0,1]</strong><br />
処理後、アタッシェケースを終了する<br />
ex). /exit=1 ※終了したくない場合は、ex). /exit=0<br />
</p>

<p>
<strong>/front=[0,1]</strong><br />
デスクトップで最前面にウィンドウを表示する<br />
ex). /front=1 ※前面にしたくない場合は、ex). /front=0<br />
</p>

<p>
<strong>/nohide=[0,1]</strong><br />
「*」で隠さずパスワードを確認しながら入力する<br />
ex). /nohide=1 ※隠して入力したい場合は、ex). /nohide=0<br />
</p>

<p>
<strong>/exeout=[0,1]</strong><br />
常に自己実行形式で出力する<br />
ex). /exeout=1 ※実行形式で出力したくない場合は、ex). /exeout=0<br />
</p>

<p>
<strong>/chkexeout=[0,1]</strong><br />
メインフォームにそのチェックボックスを表示する<br />
ex). /chkexeout=1 ※チェックボックスを表示したくない場合は、ex). /chkexeout=0<br />
</p>

<p>
<strong>/askende=[0,1]</strong><br />
暗号/復号処理かを問い合わせる<br />
ex). /askende=1 ※問い合わせをしたくないときは、ex). /askende=0<br />
</p>

<p>
<strong>/en=1</strong><br />
明示的に暗号化を指定する<br />
※このオプションを指定すると起動時に「暗号化」処理に移行します。<br />
<br />
問い合わせオプションが指定されていても無視されます。<br />
</p>

<p>
<strong>/de=1</strong><br />
明示的に復号化を指定する<br />
※このオプションを指定すると起動時に「復号化」処理に移行します。<br />
<br />
問い合わせオプションが指定されていても無視されます。<br />
</p>

<p>
<strong>/nomulti=[0,1]</strong><br />
複数起動しない<br />
ex). /nomulti=1 ※複数起動するときは、ex). /nomulti=0<br />
</p>

</div>

<h2>保存設定</h2>

<div class="paragraph">

<p>
<strong>/saveto=[PATH]</strong><br />
常に同じ場所へ暗号化ファイルを保存する<br />
ex). /saveto=MyData<br />
※パスに空白が含まれる場合は、<br />
"/saveto=C:\Documents and Settings\User1\My Documents"<br />
</p>

<p>
<strong>/dsaveto=[PATH]</strong><br />
常に同じ場所へファイルを復号化する<br />
ex). /dsaveto=MyData<br />
※パスに空白が含まれる場合は、<br />
"/saveto=C:\Documents and Settings\User1\My Documents"<br />
</p>

<p>
<strong>/ow=[0,1]</strong><br />
同名ファイルの場合、確認無しに上書きする<br />
ex). /ow=1 ※上書きを確認する場合は、ex). /ow=0<br />
</p>

<p>
<strong>/orgdt=[0,1]</strong><br />
暗号化ファイルのタイムスタンプを元ファイルに合わせる<br />
ex). /orgdt=1 ※タイムスタンプを生成時のままにしておくのは、ex). /orgdt=0<br />
</p>

<p>
<strong>/now=[0,1]</strong><br />
復号したファイルのタイムスタンプを生成日時にする<br />
ex). /now=1 ※元のタイムスタンプのままは、ex). /now=0<br />
</p>

<p>
<strong>/allpack=[0,1]</strong><br />
複数ファイルは一つの暗号化ファイルにまとめる<br />
ex). /allpack=1 ※まとめない場合は、ex). /allpack=0<br />
</p>

<p>
<strong>/oneby=[0,1]</strong><br />
フォルダ内のファイルは個別に暗号化/復号する<br />
ex). /oneby=1 ※個別に処理しない場合は、ex). /oneby=0<br />
</p>

<p>
<strong>/nopfldr=[0,1]</strong><br />
復号するときに親フォルダを生成しない<br />
ex). /nopfldr=1 ※復号するときに親フォルダを生成する場合は、ex). /oneby=0<br />
</p>

<p>
<strong>/withext=[0,1]</strong><br />
暗号化ファイル名に拡張子を含める<br />
ex). /withext=1 ※含めない場合は、ex). /withext=0<br />
</p>

<p>
<strong>/autoname=[FORMAT]</strong><br />
自動で暗号化ファイル名を付加する<br />
</p>
<p>
<blockquote>
ex). /autoname=&lt;filename&gt;_&lt;date:yymmdd&gt;&lt;ext&gt;<br />
※autonameが指定されないと、この機能はOFFとなります。<br />
※パスに空白が含まれる場合は、<br />
ex). "/autoname=&lt;filename&gt;_&lt;date:yymmdd&gt;&lt;ext&gt;"<br />
</blockquote>
</p>

</div>

<h2>削除設定</h2>

<div class="paragraph">

<p>
<strong>/del=[0,1,2,3]</strong><br />
暗号化した後、元ファイルを削除する<br />
0: 削除しない<br />
1: 通常削除<br />
2: 完全削除<br />
3: ごみ箱への削除<br />
ex). /del=1 ※元ファイル削除しない場合は、ex). /del=0<br />
</p>

<p>
<strong>/delenc=[0,1,2,3]</strong><br />
復号化した後、暗号化ファイルを削除する<br />
0: 削除しない<br />
1: 通常削除<br />
2: 完全削除<br />
3: ごみ箱への削除<br />
ex). /delenc=1 ※元ファイル削除しない場合は、ex). /delenc=0<br />
</p>

<p>
<strong>/chkdel=[0,1]</strong><br />
メインフォームにそのチェックボックスを表示する<br />
ex). /chkdel=1 ※チェックボックスを表示したくない場合は、ex). /chkdel=0<br />
</p>

<p>
<strong>/delrand=[0-99]</strong><br />
乱数を何回書き込み消去するか<br />
0-99: 書き込み回数を指定します。<br />
ex). /delrand=3 ※乱数書き込みしない場合は、ex). /delrand=0<br />
</p>

<p>
<strong>/delnull=[0-99]</strong><br />
NULLを何回書き込み消去するか<br />
0-99: 書き込み回数を指定します。<br />
ex). /delnull=3 ※乱数書き込みしない場合は、ex). /delnull=0<br />
</p>

</div>

<h2>動作設定</h2>

<div class="paragraph">

<p>
<strong>/comprate=[0-9]</strong><br />
圧縮設定（圧縮率）<br />
0-9: 圧縮率を指定します。<br />
ex). /comprate=6 ※圧縮しない場合は、ex). /comprate=0<br />
</p>

<p>
<strong>/cmp=[0,1]</strong><br />
暗号化した後にデータのコンペアを行う<br />
ex). /cmp=1 ※コンペアしない場合は、ex). /cmp=0<br />
</p>

</div>

<h2>高度設定</h2>

<div class="paragraph">

<p>
<strong>/pf=[0,1]</strong><br />
パスワードにファイルの指定を許可する<br />
ex). /pf=1 ※許可しない場合は、ex). /pf=0<br />
</p>

<p>
<strong>/pfile=[PATH]</strong><br />
暗号時のパスワードファイルパス<br />
ex). /pfile=C:\Temp\pass.txt<br />
※パスに空白が含まれる場合は、<br />
"/pfile=C:\Documents and Settings\User1\My Documents\pass.txt"<br />
</p>

<p>
<strong>/dpfile=[PATH]</strong><br />
復号時のパスワードファイルパス<br />
ex). /dpfile=C:\Temp\pass.txt<br />
※パスに空白が含まれる場合は、<br />
"/dpfile=C:\Documents and Settings\User1\My Documents\pass.txt"<br />
</p>

<p>
<strong>/nomsgp=[0,1]</strong><br />
パスワードファイルがない場合エラーを出さない<br />
ex). /nomsgp=1 ※エラーを出す場合は、ex). /nomsgp=0<br />
</p>

<p>
<strong>/camoext=[EXT]</strong><br />
暗号化ファイルの拡張子を偽装する<br />
ex). /camoext=.jpg ※偽装しない場合は、ex). /camoext=null<br />
</p>

</div>

<h2>その他（コマンドラインからのみ）</h2>

<div class="paragraph">

<p>
<strong>/4gbok=[0,1]</strong><br />
実行形式のときに出力ファイルが4GBを超えても警告メッセージを出さない<br />
※実行形式出力以外のとき、このオプションは無視されます。<br />
ex). /4gbok=1 ※出す場合は、ex). /4gbok=0<br />
</p>

<p>
<strong>/ws=[0,1,2]</strong><br />
アタッシェケース起動時にウィンドウの状態を指定します。<br />
0: 通常起動<br />
1: 最小化<br />
2: 最大化<br />
ex). /ws=1 ※この指定の場合、ウィンドウは「最小化」の状態で起動します。<br />
</p>

<p>
<strong>/list=[PATH]</strong><br />
別テキストファイルで暗号/復号処理するファイルリストを指定<br />
ex). /list=C:\Temp\list.txt<br />
※パスに空白が含まれる場合は、<br />
"/list=C:\Documents and Settings\User1\My Documents\list.txt"<br />
<br />
指定するファイルリストの書式は、1行1ファイルパスです。<br />
<br />
ex).上記のパスに指定したlist.txtの中身↓<br />
hogehoge.bmp<br />
hogehoge1.bmp<br />
hogehoge2.bmp<br />
hogehoge3.bmp<br />
tmp\temporary.htm<br />
C:\Documents and Settings\User1\My Documents\test.doc<br />
</p>
<ul>
<li>別途実行引数にファイルパスを直接入れても、併用できます<br />
	（というか一緒に処理されちゃいます）。</li>
<li>当然ですが、存在しないパスがあると処理中にエラーが発生します。</li>
</ul>

</div>

<hr />

<div class="paragraph">

<p>
こうして見ると、引数指定はけっこう煩雑ですが、既存の設定をそのままに、
変えたいところだけ一時的に引数指定すると考えて使うとわかりやすく便利かと思います。
</p>

<p>たとえば、</p>

<p class="code">
"C:\Program Files\アタッシェケース\AtchCase.exe" 企画文書１.doc /p=hirakegoma /ow=1 /exit=1 /saveto=encrypt
</p>

<p>とすれば、</p>

<p>
「<strong>企画文書１.doc</strong>」を暗号化するとして、
パスワードは「<strong>hirakegoma</strong>」、
上書きの確認無し、処理後終了、保存先は、「<strong>encrypt</strong>」フォルダとなります。
それ以外の未指定の動作設定については、既存の設定が適用されます。
</p>

</div>

<hr />
<p>Copyright&copy; 2002-2018 M.Hibara, All rights Reserved. </p>

</body>
</html>